<?xml version="1.0" ?>
<DynamicsSystem>

<SceneSettings>
    <Gravity value="10" direction="1 1 -2" />
    <TimeStepperSettings deltaT ="0.001" endTime="20">
        <InclusionSolverSettings        method="SORFull" 
                                        useGPU ="false" 
                                        useGPUID="0" 
                                        alphaJORProx="0.2" 
                                        alphaSORProx="1.2" 
                                        convergenceMethod="InVelocity"
                                        computeResidual="true"
                                        minIter = "2" maxIter="100000" 
                                        absTol="1e-6" relTol="1e-6" 
                                        isFiniteCheck = "false"/>

        <SimulateFromReference enabled="false" type="continue" file="./SimFiles/5000Balls/SimulationState.sim" />
<!--        <SimulateFromReference type="continue" file="./SimFiles/Reference/StateData.sim" enabled="true" />-->
    </TimeStepperSettings>
    
    
    <RecorderSettings recorderMode="everyTimeStep" statesPerSecond="200"/>
        
    <Visualization>
            <SceneScale value="100"/> 
    </Visualization>
     
    <ContactParameterMap>
        <ContactParameterStandard type="UCF" mu="0.5" epsilonN="0.5" epsilonT="0.0"/>
        <ContactParameter materialId1="1" materialId2="2" type="UCFD" mu="0.3" epsilonN="0.0" epsilonT="0" invDampingN="0" invDampingT="1e-4"/>
        <ContactParameter materialId1="1" materialId2="1" type="UCFD" mu="0.3" epsilonN="0.0" epsilonT="0" invDampingN="0" invDampingT="1e-4"/>
    </ContactParameterMap>
    
    <GlobalGeometries>
        <Geometry>
            <Sphere distribute="uniform" radius="0.1" seed="5" minRadius="1.1" maxRadius="1.3" id="1" instances=10 />
        </Geometry>
    </GlobalGeometries>
    
    <!-- Needs Carfull initialization from MPI if continue is activated-->
    <ExternalForces>
        <ForceField enabled="false" applyTo="all" type="spatialspherical-timerandom" seed="0" boostTime="0.8" pauseTime="1" amplitude="0.5" randomOn="true" minPoint="-6 -6 -2" maxPoint="6 6 5"  startTime="0" endTime="1000" />
    </ExternalForces>

    <GlobalInitialCondition enabled="false" relpath="./SimFiles/SimDataRECORDMPI_7500accurate/SimState.sim" whichState="time" time="3" useTimeToContinue="true"/>
    
</SceneSettings>


<MPISettings>
    
    <ProcessTopology type="grid" minPoint="-3.02 -3.02 -0.02" maxPoint="3.02 3.02 3.02" dimension="2 2 1">
        <Visualization>
            <Material name="PlaneYellowWireNoCull"/>    
        </Visualization>   
    </ProcessTopology>
    
    <InclusionSolverSettings  splitNodeUpdateRatio="1" convergenceCheckRatio="1"/>
    
</MPISettings>


<SceneObjects>
    
    <!-- For future mpi, loads all objects from a binary dump for the corresponding rank!
    Gets time from the file, initializes correctly the currentGlobalTime and so on
    <InitFromBinaryDump relpath="./asdasd/asda" />
    -->
    
    <RigidBodies name="balls" instances="20" groupId="1">
    
<!--
        <Geometry>
            <Sphere distribute="uniform" radius="0.0125" seed="5" minRadius="0.008" maxRadius="0.018" />
        </Geometry>
-->
        <Geometry>
            <GlobalGeomId distribute="uniform" id="1" seed="5" startId = "1" endId="10" />
        </Geometry>
        
        <DynamicProperties>
            <DynamicState type="simulated" />
            <Mass distribute="uniform" value="1" />
            <InertiaTensor type="homogen" />
            <Material distribute="uniform" id="1"/>
            <InitialCondition type="posvel">
                <InitialPosition distribute="grid"  gridSizeX="20" gridSizeY="20" distance="0.21" translation="-0.03 0.02 1.5" jitter="true" delta="0.000" />
<!--
                <InitialVelocity distribute="transrot">
                    <Value transDir="1 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                </InitialVelocity>
-->         
            </InitialCondition>
        </DynamicProperties>
        <Visualization>
                <Mesh file="Sphere18x18.mesh" scaleLikeGeometry="true" scale="0.0125 0.0125 0.0125" type="permutate" >
                    <Material name="SphereRed" />
                    <Material name="SphereYellow" />
                    <Material name="SphereBlue" />
                </Mesh>
        </Visualization>
    </RigidBodies>
    
    <RigidBodies name="floor/ceiling" instances="2" groupId="2">
        <Geometry>
            <Halfspace distribute="uniform" normal="0 0 1" position="0 0 0"/>
        </Geometry>
        <DynamicProperties>
            <DynamicState type="not simulated" />
            <Material distribute="uniform" id="2"/>
            <InitialCondition type="posvel">
                <InitialPosition distribute="posaxisangle" >
                                    <Value position="0 0.0 0"  axis="1 0 0" angleDegree="0"/>
                                    <Value position="0 0.0 3"  axis="1 0 0" angleDegree="180"/>
                </InitialPosition>
            </InitialCondition>
        </DynamicProperties>
        <Visualization>
                <Mesh file="Plane.mesh" scale="3 3 3" type="uniform" attachAxis="true" axesSize="0.001">
                    <Material name="PlaneBlueWireNoCull" />
                </Mesh>
        </Visualization>
    </RigidBodies>

    <RigidBodies name="sideY" instances="2" groupId="3">
        <Geometry>
            <Halfspace distribute="uniform" normal="0 0 1" position="0 0 0"/>
        </Geometry>
        <DynamicProperties>
            <DynamicState type="not simulated" />
            <Material distribute="uniform" id="2"/>
            <InitialCondition type="posvel">
                <InitialPosition distribute="posaxisangle" >
                                    <Value position="0 3 1.5"  axis="1 0 0" angleDegree="90"/>
                                    <Value position="0 -3 1.5"  axis="1 0 0" angleDegree="-90"/>
                </InitialPosition>
            </InitialCondition>
        </DynamicProperties>
        <Visualization>
                <Mesh file="Plane.mesh" scale="3 1.5 3" type="uniform" attachAxis="true" axesSize="0.001">
                    <Material name="PlaneBlueWireNoCull" />
                </Mesh>
        </Visualization>
    </RigidBodies>

    <RigidBodies name="sideX" instances="2" groupId="4">
        <Geometry>
            <Halfspace distribute="uniform" normal="0 0 1" position="0 0 0"/>
        </Geometry>
        <DynamicProperties>
            <DynamicState type="not simulated" />
            <Material distribute="uniform" id="2"/>
            <InitialCondition type="posvel">
                <InitialPosition distribute="posaxisangle" >
                                    <Value position="3 0 1.5"  axis="0 1 0" angleDegree="-90"/>
                                    <Value position="-3 0 1.5"  axis="0 1 0" angleDegree="90"/>
                </InitialPosition>
            </InitialCondition>
        </DynamicProperties>
        <Visualization>
                <Mesh file="Plane.mesh" scale="1.5 3 3" type="uniform" attachAxis="true" axesSize="0.001">
                    <Material name="PlaneBlueWireNoCull" />
                </Mesh>
        </Visualization>
    </RigidBodies>

</SceneObjects>


</DynamicsSystem>
