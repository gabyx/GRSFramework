<?xml version="1.0" ?>
<DynamicsSystem 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="SceneFile"  
    xsi:schemaLocation="SceneFile SceneFile.xsd">

<SceneSettings>

    <Visualization>
        <SceneScale value="20"/> 
    </Visualization>
    
    <RecorderSettings mode="everyTimeStep" everyXStep="10"/>
    
    <TimeStepperSettings deltaT ="0.001" endTime="1">
        <InclusionSolverSettings        method="SORContact" 
                                        
                                        useGPU ="false" 
                                        useGPUID="0" 
                                        alphaJORProx="0.2" 
                                        alphaSORProx="1.5" 
                                        driftCorrectionGap="false"
                                        driftCorrectionGapAlpha="0.3"
                                        matrixRStrategy="max"
                                        computeResidual="true"
                                        usePercussionCache="false"
                                        reserveContacts="0"
                                        convergenceMethod="InVelocity"
                                        minIter="0" maxIter="50" 
                                        absTol="1e-6" relTol="1e-6" 
                                        isFiniteCheck = "false"/>

<!--
        <SimulateFromReference enabled="false" type="continue" file="./SimFiles/5000Balls/SimulationState.sim" />
-->
<!--
        <SimulateFromReference type="continue" file="./SimFiles/Reference/StateData.sim" enabled="true" />
-->
    </TimeStepperSettings>
     
    <ContactParameterMap>
        <ContactParameterStandard type="UCF" mu="0.5" epsilonN="0.5" epsilonT="0.0"/>
        <ContactParameter materialId1="1" materialId2="2" type="UCF"  mu="0.3" epsilonN="0.0" epsilonT="0.0" invDampingN="1e-6" invDampingT="1e-6"/>
        <ContactParameter materialId1="1" materialId2="1" type="UCF"  mu="0.3" epsilonN="0.0" epsilonT="0.0" invDampingN="1e-6" invDampingT="1e-6"/>
    </ContactParameterMap>
    
<!--
    <GlobalGeometries>
        <Sphere distribute="random" radius="0.08" seed="5" minRadius="0.17" maxRadius="0.2" id="1" instances="1000000" />
    </GlobalGeometries>
-->
    
    <ExternalForces>
<!--
        <ForceField  applyTo="all" type="spatialspherical-timerandom" seed="0" boostTime="0.3" pauseTime="5" amplitude="30" randomOn="true" minPoint="-6 -6 -2" maxPoint="6 6 5"  startTime="0" endTime="1000" />
-->
        <ForceField  applyTo="all" type="gravity" value="9.81" direction="0 0 -1" />
    </ExternalForces>
        


<!--
    <GlobalInitialCondition file="GlobalFolder/SimFiles/SimDataRECORDMPI_0/SimState.sim" whichState="end" time="2.0499" useTimeToContinue="true" readVelocities="true"/>
-->

<!--
    <GlobalInitialCondition file="SimFiles/SimDataRECORDGUI_1/SimState.sim" whichState="end" time="2.0499" useTimeToContinue="true"/>
-->



    <GlobalSelectiveIds>
        <Set>0,0 0,2 0,4 0,3</Set>
    </GlobalSelectiveIds>


    
    <MPISettings>
        <ProcessTopology mode="dynamic" doLocalComputations="true" policy="alwaysRebuild" policyCheckEveryXTimeStep="250" bodyLimit="5000">
            <Topology type="grid"  dimension="2 2 1" buildMode="MVBB" minGridSize="0.01" aligned="true" minPoint="-2 -2 2.5 " maxPoint="2 2 3.5"/>
            <MassPointPrediction nPoints="100" deltaT="0.01"/>
            <GlobalOutlierFilter kNNMean="20" stdDeviationMult="0.9" allowSplitAbove="10"/>
            <Visualization>
                <Material name="PlaneYellowWireNoCull"/>    
            </Visualization>   
        </ProcessTopology>
        
        <InclusionSolverSettings  splitNodeUpdateRatio="1" convergenceCheckRatio="1" reserveSplitNodes="2000"/>
    </MPISettings>
    
</SceneSettings>




<SceneObjects>


    <RigidBodies name="balls1" instances="200" groupId="0" enableSelectiveIds="true" >
        

        <Geometry>
            <Sphere distribute="random" generator="piecewise-const" intervals="0.1 0.15 0.2" densities="2 1" seed="5"/>
        </Geometry>

<!--
        <Geometry>
            <GlobalGeomId distribute="random" id="1" seed="1" startId = "1" endId="10" />
        </Geometry>
-->
        
        <DynamicProperties>
            <DynamicState type="simulated" />
            <Mass distribute="homogen" density="2400" />
            <InertiaTensor type="homogen" />
            <Material distribute="uniform" id="1"/>
            <InitialCondition type="posvel">
                <InitialPosition distribute="grid"  gridSizeX="10" gridSizeY="10" distance="0.5" translation="0.00 0.00 2.0" jitter="true"  seed="4" delta="0.02"/>

                <InitialVelocity distribute="transrot">
                    <Vel transDir="0 0 -1" absTransVel="10" rotDir="1 0 0" absRotVel="0"/>
                </InitialVelocity>
         
            </InitialCondition>
        </DynamicProperties>

        <Visualization>
<!--
            <PointCloud scale="1 1 1" color="0.2 0.3 0.4 0.2"/>
-->
                <Mesh file="Sphere18x18.mesh" scaleLikeGeometry="true" scale="0.0125 0.0125 0.0125" type="permutate" >
                    <Material name="SphereRed" />
                    <Material name="SphereYellow" />
                    <Material name="SphereBlue" />
                </Mesh>
        </Visualization>

    </RigidBodies>
    
    
<!--
    <RigidBodies name="balls2" instances="9" groupId="1" enableSelectiveIds="true" >
        

        <Geometry>
            <GlobalGeomId distribute="random" id="0" seed="2" startId = "1" endId="10" />
        </Geometry>
        
        <DynamicProperties>
            <DynamicState type="simulated" />
            <Mass distribute="uniform" value="1" />
            <InertiaTensor type="homogen" />
            <Material distribute="uniform" id="1"/>
            <InitialCondition type="posvel">
                <InitialPosition distribute="grid"  gridSizeX="3" gridSizeY="3" distance="1" translation="0.0 0.0 1" jitter="false"  seed="4" delta="0.2"/>

                <InitialVelocity distribute="transrot">
                    <Vel transDir="1 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 -1" absTransVel="1" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 1 1" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 -1 0" absTransVel="1" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 1" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 0 0" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 1 1" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                     <Vel transDir="1 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 -1" absTransVel="1" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 1 1" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 -1 0" absTransVel="1" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 1" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 0 0" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 1 1" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                     <Vel transDir="1 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 -1" absTransVel="1" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 1 1" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 -1 0" absTransVel="1" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 1" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 0 0" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 1 1" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                </InitialVelocity>
         
            </InitialCondition>
        </DynamicProperties>

        <Visualization>
                <Mesh file="Sphere18x18.mesh" scaleLikeGeometry="true" scale="0.0125 0.0125 0.0125" type="permutate" >
                    <Material name="SphereRed" />
                    <Material name="SphereYellow" />
                    <Material name="SphereBlue" />
                </Mesh>
        </Visualization>

    </RigidBodies>
    
    
     <RigidBodies name="balls3" instances="9" groupId="1" enableSelectiveIds="true" >
        
        
        <Geometry>
            <GlobalGeomId distribute="random" id="0" seed="3" startId = "1" endId="10" />
        </Geometry>
        
        <DynamicProperties>
            <DynamicState type="simulated" />
            <Mass distribute="uniform" value="1" />
            <InertiaTensor type="homogen" />
            <Material distribute="uniform" id="1"/>
            <InitialCondition type="posvel">
                <InitialPosition distribute="grid"  gridSizeX="3" gridSizeY="3" distance="1" translation="0.0 0.0 0.25" jitter="false"  seed="4" delta="0.2"/>

                <InitialVelocity distribute="transrot">
                    <Vel transDir="1 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 -1" absTransVel="1" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 1 1" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 -1 0" absTransVel="1" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 1" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 0 0" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 1 1" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                     <Vel transDir="1 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                     <Vel transDir="1 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 -1" absTransVel="1" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 1 1" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                     <Vel transDir="1 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                     <Vel transDir="1 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 1" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 0 0" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="1 1 0" absTransVel="2" rotDir="1 0 0" absRotVel="0"/>
                    <Vel transDir="0 1 1" absTransVel="3" rotDir="1 0 0" absRotVel="0"/>
                </InitialVelocity>
         
            </InitialCondition>
        </DynamicProperties>

        <Visualization>
                <Mesh file="Sphere18x18.mesh" scaleLikeGeometry="true" scale="0.0125 0.0125 0.0125" type="permutate" >
                    <Material name="SphereRed" />
                    <Material name="SphereYellow" />
                    <Material name="SphereBlue" />
                </Mesh>
        </Visualization>

    </RigidBodies>
-->

    <RigidBodies name="floor/ceiling" instances="1" groupId="2">
        <Geometry>
            <Halfspace distribute="uniform" normal="0 0 1" position="0 0 0"/>
        </Geometry>
        <DynamicProperties>
            <DynamicState type="static" />
            <Material distribute="uniform" id="2"/>
            <InitialCondition type="posvel">
                <InitialPosition distribute="transforms" >
                                     <Pos><Trafo trans="0 0.0 0"  axis="1 0 0" deg="0"/></Pos>
                                     <Pos><Trafo trans="0 0.0 6"  axis="1 0 0" deg="180"/></Pos>

                </InitialPosition>
            </InitialCondition>
        </DynamicProperties>
        <Visualization>
                <Mesh file="Plane.mesh" scale="3 3 3" type="uniform" >
                    <Rendering attachAxis="true" axesSize="0.01"/>
                    <Material name="PlaneBlueWireNoCull" />
                </Mesh>
        </Visualization>
    </RigidBodies>
    
    <RigidBodies name="capsule" instances="1" groupId="2">
        <Geometry>
            <Capsule distribute="uniform" normal="0 0 1" radius="1" length="2" position="0 0 0"/>
        </Geometry>
        <DynamicProperties>
            <DynamicState type="static" />
            <Material distribute="uniform" id="2"/>
            <InitialCondition type="posvel">
                <InitialPosition distribute="transforms" >
                        <Pos><Trafo trans="0 0.0 0.5"  axis="1 1 0" deg="90"/></Pos>
                </InitialPosition>
            </InitialCondition>
        </DynamicProperties>
        <Visualization>
                <Capsule fileZylinder="Cylinder.mesh" fileCap="HalfSphere.mesh" radius="1" length="2"  scaleLikeGeometry="false" type="uniform" >
                    <Rendering attachAxis="true" axesSize="0.01"/>
                    <Material name="SphereYellow" />
                </Capsule>
<!--
            <Mesh file="Cylinder.mesh" scale="3 3 3" type="uniform" >
                    <Rendering attachAxis="true" axesSize="0.01"/>
                    <Material name="PlaneBlueWireNoCull" />
            </Mesh>
-->
        </Visualization>
    </RigidBodies>
    

    <RigidBodies name="sideY" instances="2" groupId="3">
        <Geometry>
            <Halfspace distribute="uniform" normal="0 0 1" position="0 0 0"/>
        </Geometry>
        <DynamicProperties>
            <DynamicState type="static" />
            <Material distribute="uniform" id="2"/>
            <InitialCondition type="posvel">
                <InitialPosition distribute="transforms" >
                                     <Pos><Trafo trans="0 3 3"  axis="1 0 0" deg="90"/></Pos>
                                     <Pos><Trafo trans="0 -3 3"  axis="1 0 0" deg="-90"/></Pos>
                </InitialPosition>
            </InitialCondition>
        </DynamicProperties>
        <Visualization>
                <Mesh file="Plane.mesh" scale="3 3 3" type="uniform">
                    <Rendering attachAxis="true" axesSize="0.01"/>
                    <Material name="PlaneBlueWireNoCull" />
                </Mesh>
        </Visualization>
    </RigidBodies>



    <RigidBodies name="sideX" instances="2" groupId="4">
        <Geometry>
            <Halfspace distribute="uniform" normal="0 0 1" position="0 0 0"/>
        </Geometry>
        <DynamicProperties>
            <DynamicState type="static" />
            <Material distribute="uniform" id="2"/>
            <InitialCondition type="posvel">
                <InitialPosition distribute="transforms" >
                                    <Pos><Trafo trans="3 0 3"  axis="0 1 0" deg="-90"/></Pos>
                                    <Pos><Trafo trans="-3 0 3"  axis="0 1 0" deg="90"/></Pos>
                </InitialPosition>
            </InitialCondition>
        </DynamicProperties>
        <Visualization>
                <Mesh file="Plane.mesh" scale="3 3 3" type="uniform">
                    <Rendering attachAxis="true" axesSize="0.001"/>
                    <Material name="PlaneBlueWireNoCull" />
                </Mesh>
        </Visualization>
    </RigidBodies>



</SceneObjects>


</DynamicsSystem>
