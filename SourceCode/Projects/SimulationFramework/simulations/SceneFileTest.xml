<?xml version="1.0" ?>
<DynamicsSystem 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="SceneFile"  
    xsi:schemaLocation="SceneFile SceneFile.xsd">

    <SceneSettings>

        <Visualization>
            <SceneScale value="100"/> 
        </Visualization>

        <RecorderSettings mode="everyTimeStep" statesPerSecond="30"/>

        <TimeStepperSettings deltaT ="0.002" endTime="2.5">
            <InclusionSolverSettings        method="SORContact" 
                useGPU ="false" 
                useGPUID="0" 
                alphaJORProx="0.2" 
                alphaSORProx="1.5" 
                matrixRStrategy="max"
                driftCorrectionGap="false" 
                driftCorrectionGapAlpha="0.01"
                usePercussionCache="false"
                reserveContacts="0"
                computeResidual="false"
                computeTotalOverlap="true"
                convergenceMethod="InVelocity"
                minIter="0" maxIter="1000" 
                absTol="1e-6" relTol="1e-6" 
                isFiniteCheck = "false"/>

        </TimeStepperSettings>
        
        <MPISettings>
            <ProcessTopology mode="dynamic" policy="alwaysRebuild" policyCheckEveryXTimeStep="50" bodyLimit="5000">
                <Topology type="grid"  dimension="4 1 1" matchProcessDimToExtent="true" buildMode="AABB" minGridSize="5e-3" aligned="true" minPoint="-2 -2 2.5 " maxPoint="2 2 3.5"/>
                <MassPointPrediction nPoints="5" deltaT="0.01"/>
                <Visualization>
                    <Material name="PlaneYellowWireNoCull"/>    
                </Visualization>   
            </ProcessTopology>

            <InclusionSolverSettings  splitNodeUpdateRatio="1" convergenceCheckRatio="1" reserveSplitNodes="0"/>
        </MPISettings>


        <ContactParameterMap>
            <ContactParameterStandard type="UCF" mu="0.5" epsilonN="0.5" epsilonT="0.0"/>
            <ContactParameter materialId1="0" materialId2="0" type="UCF"  mu="0.3" epsilonN="0.0" epsilonT="0" invDampingN="0" invDampingT="0"/>
            <ContactParameter materialId1="1" materialId2="2" type="UCF"  mu="0.5" epsilonN="0.0" epsilonT="0" invDampingN="0" invDampingT="0"/>
            <ContactParameter materialId1="1" materialId2="3" type="UCF"  mu="0.1" epsilonN="0.0" epsilonT="0" invDampingN="0" invDampingT="0"/>
        </ContactParameterMap>

        <GlobalGeometries>
            <!-- Sphere distribute="random" generator="normal" seed="5" mean="1.4e-3" variance="1.52795e-4" minRadius="0.59e-3" maxRadius="1e-3" id="1" instances="10001" -->
        </GlobalGeometries>

        <ExternalForces>
            <ForceField  applyTo="all" type="gravity" value="9.81" direction="-0.5 0 -0.866025404" /> 

            <!-- 27 degrees
            <ForceField  applyTo="all" type="gravity" value="10" direction="-0.4539905 0 -0.891006524" /> 
            -->
        </ExternalForces>

        <!--
        <GlobalInitialCondition file="/cluster/work/scr1/nuetzig/Avalanche1M-FillUp1.4/SimFiles/SimDataRECORDMPI_0/SimState.sim" whichState="end"  useTimeToContinue="true"/>
        -->

        <!--
        <GlobalSelectiveIds>
            <Set value="0,0  0,9 0,3" />
        </GlobalSelectiveIds>
        -->

    </SceneSettings>

    <SceneObjects>
        
        <RigidBodies name="beads" instances="500" groupId="0" enableSelectiveIds="true" >


            <Geometry>
                <Sphere distribute="random" generator="piecewise-const" intervals="0.59e-3 0.7e-3 0.85e-3 1e-3 1.18e-3" densities="1.3681 1.9913 0.29116 0.03956" seed="5"/>
            </Geometry>
            <!--
            <Geometry>
                <GlobalGeomId distribute="random" id="1" seed="1" startId = "1" endId="10000" />
            </Geometry>
            -->
            <DynamicProperties>
                <DynamicState type="simulated" />
                <Mass distribute="homogen" density="2400" />
                <InertiaTensor type="homogen" />
                <Material distribute="uniform" id="1"/>
                <InitialCondition type="posvel">
                    <InitialPosition distribute="grid"  gridSizeX="60" gridSizeY="80" 
                        distance="2.36e-3" translation="0.01 0 0.071" jitter="true"  seed="4" delta="0.1e-3"
                        dirZ="1 0 0" dirX="0 0 1"/>
                    <!--
                    <InitialVelocity distribute="transrot">
                        <Vel transDir="-0.5 0 -0.8" absTransVel="0.0" rotDir="1 0 0" absRotVel="0" />
                    </InitialVelocity>
                    -->
                </InitialCondition>
            </DynamicProperties>

            <Visualization>
                
<!--
                <PointCloud scale="0.1 0.1 0.1" color="0.2 0.3 0.4 1.0" renderMode="spheres"/>
                
-->

                <Mesh file="Sphere18x18.mesh" scaleLikeGeometry="true" scale="0.0125 0.0125 0.0125" type="permutate" >
                    <Material name="SphereRed" />
                    <Material name="SphereYellow" />
                    <Material name="SphereBlue" />
                </Mesh>

            </Visualization>

        </RigidBodies>


        <RigidBodies name="floor/ceiling" instances="1" groupId="2">
            <Geometry>
                <Halfspace distribute="uniform" normal="0 0 1" position="0 0 0"/>
            </Geometry>
            <DynamicProperties>
                <DynamicState type="static" />
                <Material distribute="uniform" id="2"/>
                <InitialCondition type="posvel">
                    <InitialPosition distribute="transforms" >
                        <Pos><Trafo trans="0 0.0 0"  axis="1 0 0" deg="0"/></Pos>
                        <!--
                        <Pos><Trafo trans="0 0.0 3"  axis="1 0 0" deg="180"/></Pos>
                        -->
                    </InitialPosition>
                </InitialCondition>
            </DynamicProperties>
            <Visualization>
                <Mesh file="Plane.mesh" scale="2 0.1 1" type="uniform" >
                    <Rendering attachAxis="true" axesSize="0.01"/>
                    <Material name="PlaneBlueWireNoCull" />
                </Mesh>
            </Visualization>
        </RigidBodies>

        <RigidBodies name="sideY" instances="2" groupId="3">
            <Geometry>
                <Halfspace distribute="uniform" normal="0 0 1" position="0 0 0"/>
            </Geometry>
            <DynamicProperties>
                <DynamicState type="static" />
                <Material distribute="uniform" id="3"/>
                <InitialCondition type="posvel">
                    <InitialPosition distribute="transforms" >
                        <Pos><Trafo trans="0 0.1 0.25"  axis="1 0 0" deg="90"/></Pos>
                        <Pos><Trafo trans="0 -0.1 0.25"  axis="1 0 0" deg="-90"/></Pos>
                    </InitialPosition>
                </InitialCondition>
            </DynamicProperties>
            <Visualization>
                <Mesh file="Plane.mesh" scale="2 0.25 1" type="uniform">
                    <Rendering attachAxis="true" axesSize="0.01"/>
                    <Material name="PlaneBlueWireNoCull" />
                </Mesh>
            </Visualization>
        </RigidBodies>




        <RigidBodies name="sideX" instances="1" groupId="4">
            <Geometry>
                <Halfspace distribute="uniform" normal="0 0 1" position="0 0 0"/>
            </Geometry>
            <DynamicProperties>
                <DynamicState type="static" />
                <Material distribute="uniform" id="3"/>
                <InitialCondition type="posvel">
                    <InitialPosition distribute="transforms" >
                        <!--
                        <Pos><Trafo trans="1 0 0.25"  axis="0 1 0" deg="-90"/></Pos>
                        -->
                        <Pos><Trafo trans="0 0 0.25"  axis="0 1 0" deg="90"/></Pos>
                    </InitialPosition>
                </InitialCondition>
            </DynamicProperties>
            <Visualization>
                <Mesh file="Plane.mesh" scale="0.25 0.1 1" type="uniform">
                    <Rendering attachAxis="true" axesSize="0.001"/>
                    <Material name="PlaneBlueWireNoCull" />
                </Mesh>
            </Visualization>
        </RigidBodies>
    </SceneObjects>
</DynamicsSystem>
