(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    144548,       3756]
NotebookOptionsPosition[    140626,       3620]
NotebookOutlinePosition[    140984,       3636]
CellTagsIndexPosition[    140941,       3633]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Formatting Stuff", "Subsection",
 CellChangeTimes->{{3.593343121476918*^9, 3.59334312905704*^9}, 
   3.593350060433502*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "\n", 
    RowBox[{"Remove", "[", "\"\<MultiProcessorProx`*\>\"", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Needs", "[", "\"\<Notation`\>\"", "]"}], ";"}], "\n", 
   RowBox[{"Symbolize", "[", 
    RowBox[{"ParsedBoxWrapper", "[", 
     RowBox[{"SubscriptBox", "[", 
      RowBox[{"\"\<_\>\"", ",", " ", "\"\<_\>\""}], "]"}], "]"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Symbolize", "[", 
    RowBox[{"ParsedBoxWrapper", "[", 
     RowBox[{"SubsuperscriptBox", "[", 
      RowBox[{"\"\<_\>\"", ",", " ", "\"\<_\>\"", ",", "\"\<_\>\""}], "]"}], 
     "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Dont", " ", "create", " ", "subsuperscripts", " ", "with", " ", 
      "keyboard"}], ",", " ", 
     RowBox[{"use", " ", "the", " ", 
      RowBox[{"command", "!!"}], " ", "Mma", " ", "interpretes", " ", "this", 
      " ", "as", " ", 
      RowBox[{"Power", "[", 
       RowBox[{"Subscriopt", "[", "..", "]"}], "]"}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"CreateWindow", "[", 
      RowBox[{"PaletteNotebook", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<Usefull Buttons\>\"", ",", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Restart Kernel\>\"", ",", " ", 
           RowBox[{"Quit", "[", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], "]"}], "\[IndentingNewLine]", "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Begin", "[", "\"\<MultiProcessorProx`\>\"", "]"}], ";"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{"MyMatrixStyle", "[", "M_", "]"}], "]"}], ":=", 
     RowBox[{"Framed", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{"M", ",", 
           RowBox[{"Dividers", "\[Rule]", "Center"}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Thickness", "[", "0.1", "]"}], "}"}]}]}], "]"}], ",", 
         "Bold"}], "]"}], ",", 
       RowBox[{"RoundingRadius", "\[Rule]", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.593343119269236*^9, 3.593343145946354*^9}, {
   3.593344387256568*^9, 3.593344402477955*^9}, {3.593344443105891*^9, 
   3.59334447462059*^9}, {3.593344521501732*^9, 3.5933445363739653`*^9}, {
   3.593419359308861*^9, 3.593419362990939*^9}, {3.593419518045542*^9, 
   3.593419523041453*^9}, {3.5934358860358963`*^9, 3.593435902707738*^9}, 
   3.593436276915718*^9, {3.593438196854657*^9, 3.5934381972393*^9}, {
   3.593438227712908*^9, 3.593438227990808*^9}, {3.5934386014468*^9, 
   3.593438653849805*^9}, {3.593438699052376*^9, 3.593438705318589*^9}, 
   3.593439310556883*^9, {3.5934393466449966`*^9, 3.593439390935453*^9}, {
   3.593440199471116*^9, 3.593440232165097*^9}, {3.593440724559744*^9, 
   3.593440792305605*^9}, {3.593440874639697*^9, 3.593440874900161*^9}, {
   3.5934409457109823`*^9, 3.593440945864118*^9}, {3.593441061559044*^9, 
   3.59344108158668*^9}, {3.593441143671494*^9, 3.5934411914369926`*^9}, {
   3.593441308415387*^9, 3.593441323730289*^9}, {3.593441374880713*^9, 
   3.59344137678185*^9}, {3.593441436616495*^9, 3.593441448096294*^9}, {
   3.593441487469153*^9, 3.5934415437313004`*^9}, {3.59344159435295*^9, 
   3.593441611320842*^9}, 3.593442358286899*^9, {3.593442419223524*^9, 
   3.593442427407955*^9}, {3.593442529444591*^9, 3.593442531909539*^9}, {
   3.5934426572560673`*^9, 3.5934426583489733`*^9}, {3.59344279535454*^9, 
   3.593442821049183*^9}, {3.593443091861836*^9, 3.593443099079596*^9}, {
   3.5934431383572807`*^9, 3.5934431641428003`*^9}, 3.593443204522786*^9, {
   3.5934432708271923`*^9, 3.5934432734940653`*^9}, {3.593443822749229*^9, 
   3.593443824409561*^9}, {3.5934445311037807`*^9, 3.5934445342915993`*^9}, {
   3.593445399050557*^9, 3.593445399807495*^9}, 3.594448982559717*^9, {
   3.594449030660779*^9, 3.594449040835816*^9}, {3.594449719861285*^9, 
   3.594449722616066*^9}, {3.594449760352685*^9, 3.594449768036628*^9}, {
   3.5963610396356897`*^9, 3.596361044067824*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Some", " ", "Matrix", " ", "Block", " ", "Definitions"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Needs", "[", "\"\<Notation`\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{RowBox[{"A_", "\[CenterDot]", "B_"}]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{RowBox[{"BlockMultiply", "[", 
          RowBox[{"A_", ",", "B_"}], "]"}]},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox["A_", "Inv"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{RowBox[{"BlockInv", "[", "A_", "]"}]},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox["A_", "T"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{RowBox[{"BlockTransp", "[", "A_", "]"}]},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Needs", "[", "\"\<Notation`\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{RowBox[{"A_", "\[CenterDot]", "B_"}]},
       "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", " ", 
      TemplateBox[{RowBox[{"BlockMultiply", "[", 
          RowBox[{"A_", ",", "B_"}], "]"}]},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox["A_", "Inv"]},
       "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", " ", 
      TemplateBox[{RowBox[{"BlockInv", "[", "A_", "]"}]},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox["A_", "T"]},
       "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", " ", 
      TemplateBox[{RowBox[{"BlockTransp", "[", "A_", "]"}]},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{RowBox[{"A_", "\[CenterDot]", "B_"}]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", " ", 
      TemplateBox[{RowBox[{"BlockMultiply", "[", 
          RowBox[{"A_", ",", "B_"}], "]"}]},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox["A_", "Inv"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", " ", 
      TemplateBox[{RowBox[{"BlockInv", "[", "A_", "]"}]},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox["A_", "T"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", " ", 
      TemplateBox[{RowBox[{"BlockTransp", "[", "A_", "]"}]},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "BlockTransp", "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"SetAttributes", "[", 
     RowBox[{"BlockTransp", ",", "OneIdentity"}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockTransp", "[", "M_List", "]"}], " ", ":=", " ", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"BlockTransp", "[", "#", "]"}], "&"}], ",", 
      RowBox[{"Transpose", "[", "M", "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockTransp", "[", 
     RowBox[{"M__", " ", "+", " ", "B__"}], " ", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"BlockTransp", "[", "M", "]"}], "+", " ", 
     RowBox[{"BlockTransp", "[", "B", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BlockTransp", "[", 
      RowBox[{"a_", " ", "/;", " ", 
       RowBox[{"NumberQ", "[", "a", "]"}]}], "]"}], " ", ":=", "a"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BlockTransp", "[", "a_Scalar", " ", "]"}], " ", ":=", "a"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BlockTransp", "[", 
      RowBox[{
       RowBox[{"a_", "   ", "M__"}], " ", "/;", " ", 
       RowBox[{"NumberQ", "[", "a", "]"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"a", " ", 
      RowBox[{"BlockTransp", "[", "M", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BlockTransp", "[", 
      RowBox[{"a_Scalar", "   ", "M__"}], "]"}], " ", ":=", " ", 
     RowBox[{"a", " ", 
      RowBox[{"BlockTransp", "[", "M", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockTransp", "[", 
     RowBox[{"BlockMultiply", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], " ", "]"}], ":=", 
    RowBox[{"BlockMultiply", "[", 
     RowBox[{
      RowBox[{"BlockTransp", "[", "y", "]"}], ",", 
      RowBox[{"BlockTransp", "[", "x", "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockTransp", "[", 
     RowBox[{"BlockTransp", "[", "x_", "]"}], "]"}], ":=", "x"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "BlockMultiply", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockMultiply", "[", 
     RowBox[{
      RowBox[{"mats1", " ", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", " ", ".."}], "}"}], ".."}], "}"}]}], ",", 
      RowBox[{"mats2", " ", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", " ", ".."}], "}"}], ".."}], "}"}]}]}], "]"}], ":=", 
    RowBox[{"Inner", "[", 
     RowBox[{"BlockMultiply", ",", "mats1", ",", "mats2"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "numbers"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockMultiply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a_", " ", "A_"}], "/;", " ", 
       RowBox[{"NumberQ", "[", "a", "]"}]}], ",", "B_"}], "]"}], ":=", 
    RowBox[{"a", " ", 
     RowBox[{"BlockMultiply", "[", 
      RowBox[{"A", ",", "B"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockMultiply", "[", 
     RowBox[{"A_", " ", ",", 
      RowBox[{
       RowBox[{"a_", " ", "B_"}], " ", "/;", " ", 
       RowBox[{"NumberQ", "[", "a", "]"}]}]}], "]"}], ":=", 
    RowBox[{"a", " ", 
     RowBox[{"BlockMultiply", "[", 
      RowBox[{"A", ",", "B"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockMultiply", "[", 
     RowBox[{"A__", " ", ",", 
      RowBox[{"a_", " ", "/;", " ", 
       RowBox[{"NumberQ", "[", "a", "]"}]}]}], "]"}], ":=", 
    RowBox[{"a", " ", "A"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockMultiply", "[", 
     RowBox[{
      RowBox[{"a_", " ", "/;", " ", 
       RowBox[{"NumberQ", "[", "a", "]"}]}], ",", " ", "A__"}], " ", "]"}], ":=", 
    RowBox[{"a", " ", "A"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "scalar", " ", "symbols"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockMultiply", "[", 
     RowBox[{
      RowBox[{"a_Scalar", " ", "A_"}], ",", "B_"}], "]"}], ":=", 
    RowBox[{"a", " ", 
     RowBox[{"BlockMultiply", "[", 
      RowBox[{"A", ",", "B"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockMultiply", "[", 
     RowBox[{"A_", " ", ",", 
      RowBox[{"a_Scalar", " ", "B_"}]}], " ", "]"}], ":=", 
    RowBox[{"a", " ", 
     RowBox[{"BlockMultiply", "[", 
      RowBox[{"A", ",", "B"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockMultiply", "[", 
     RowBox[{"A__", ",", " ", "a_Scalar"}], " ", "]"}], ":=", 
    RowBox[{"a", " ", "A"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockMultiply", "[", 
     RowBox[{"a_Scalar", ",", " ", "A__"}], " ", "]"}], ":=", 
    RowBox[{"a", " ", "A"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "BlockInv", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BlockInv", "[", 
      RowBox[{"mats1", " ", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", " ", ".."}], "}"}], ".."}], "}"}]}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BlockInv", "[", "#", "]"}], "&"}], ",", "mats1", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockInv", "[", " ", 
     RowBox[{"a_", " ", "/;", " ", 
      RowBox[{"NumberQ", "[", "a", "]"}]}], "]"}], " ", ":=", " ", "a"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockInv", "[", " ", "a_Scalar", "]"}], " ", ":=", " ", "a"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockInv", "[", " ", 
     RowBox[{
      RowBox[{"a_", " ", "A__"}], "/;", " ", 
      RowBox[{"NumberQ", "[", "a", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{
     FractionBox["1", "a"], 
     RowBox[{"BlockInv", "[", "A", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockInv", "[", " ", 
     RowBox[{"a_Scalar", " ", "A__"}], "]"}], " ", ":=", " ", 
    RowBox[{
     FractionBox["1", "a"], 
     RowBox[{"BlockInv", "[", "A", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Scalar", "[", 
     RowBox[{"a_", " ", "/;", " ", 
      RowBox[{"NumberQ", "[", "a", "]"}]}], "]"}], ":=", " ", "a"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Make", " ", "some", " ", "formatting", " ", "expression"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Scalar", "/:", " ", 
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"Scalar", "[", "a_", "]"}], ",", "StandardForm"}], "]"}], ":=", 
     RowBox[{"MakeBoxes", "[", 
      RowBox[{"a", ",", "StandardForm"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{"MyMatrixStyle", "[", "M_", "]"}], "]"}], ":=", 
     RowBox[{"Framed", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{"M", ",", 
           RowBox[{"Dividers", "\[Rule]", "Center"}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Thickness", "[", "0.1", "]"}], "}"}]}]}], "]"}], ",", 
         "Bold"}], "]"}], ",", 
       RowBox[{"RoundingRadius", "\[Rule]", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"BlockMultiply", " ", "/:", " ", 
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"BlockMultiply", "[", 
        RowBox[{"A_", ",", "B_"}], "]"}], ",", "StandardForm"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"StyleBox", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"RowBox", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MakeBoxes", "[", 
             RowBox[{"A", ",", "StandardForm"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"MakeBoxes", "[", 
             RowBox[{"B", ",", "StandardForm"}], "]"}]}], "}"}], 
          "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"ZeroWidthTimes", "\[Rule]", "True"}]}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "BlockTransp"}], 
      " ", "/:", " ", 
      RowBox[{"MakeBoxes", "[", 
       RowBox[{
        RowBox[{"BlockTransp", "[", "A_", "]"}], ",", "StandardForm"}], "]"}],
       ":=", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SuperscriptBox", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MakeBoxes", "[", 
           RowBox[{"A", ",", "StandardForm"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StyleBox", "[", 
           RowBox[{
            RowBox[{"MakeBoxes", "[", 
             RowBox[{"\"\<T\>\"", ",", "StandardForm"}], "]"}], ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", " ", 
            RowBox[{"FontSize", "\[Rule]", "9"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "BlockInv"}], 
       " ", "/:", " ", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         RowBox[{"BlockInv", "[", "A_", "]"}], ",", "StandardForm"}], "]"}], ":=",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"SuperscriptBox", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MakeBoxes", "[", 
            RowBox[{"A", ",", "StandardForm"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"StyleBox", "[", 
            RowBox[{
             RowBox[{"MakeBoxes", "[", 
              RowBox[{"\"\<-1\>\"", ",", "StandardForm"}], "]"}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", " ", 
             RowBox[{"FontSize", "\[Rule]", "9"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "BlockInv"}], " ", "/:", " ", 
        RowBox[{"MakeBoxes", "[", 
         RowBox[{
          RowBox[{"BlockInv", "[", 
           RowBox[{"BlockTransp", "[", "A_", "]"}], "]"}], ",", 
          "StandardForm"}], "]"}], ":=", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SuperscriptBox", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MakeBoxes", "[", 
             RowBox[{"A", ",", "StandardForm"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"StyleBox", "[", 
             RowBox[{
              RowBox[{"MakeBoxes", "[", 
               RowBox[{"\"\<-T\>\"", ",", "StandardForm"}], "]"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", " ", 
              RowBox[{"FontSize", "\[Rule]", "9"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
          "BlockTransp"}], " ", "/:", " ", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           RowBox[{"BlockTransp", "[", 
            RowBox[{"BlockInv", "[", "A_", "]"}], "]"}], ",", 
           "StandardForm"}], "]"}], ":=", "\[IndentingNewLine]", 
         RowBox[{"SuperscriptBox", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MakeBoxes", "[", 
            RowBox[{"A", ",", "StandardForm"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"StyleBox", "[", 
            RowBox[{
             RowBox[{"MakeBoxes", "[", 
              RowBox[{"\"\<-T\>\"", ",", "StandardForm"}], "]"}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", " ", 
             RowBox[{"FontSize", "\[Rule]", "9"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}]}]}]}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.594450106518038*^9, 3.594450114865753*^9}, {
   3.594450278226204*^9, 3.594450287956956*^9}, {3.594450687877975*^9, 
   3.594450689991037*^9}, {3.594470530275166*^9, 3.594470562908073*^9}, {
   3.5944706368103237`*^9, 3.594470637243074*^9}, {3.594470861645546*^9, 
   3.5944709519140797`*^9}, {3.594471236547338*^9, 3.594471237243828*^9}, 
   3.5945311629415293`*^9, 3.594531295460464*^9, 3.59453135315453*^9, {
   3.594559532248027*^9, 3.5945595446247997`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ExpandMatrix", "[", "A_", "]"}], ":=", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"ReleaseHold", "[", "A", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Makes", " ", "a", " ", "special", " ", "Symb"}], ",", " ", 
     RowBox[{
     "needs", " ", "Notation", " ", "Package", "\[IndentingNewLine]", "\t", 
      "Inputs", " ", "can", " ", "be", " ", "a", " ", "string"}], ",", " ", 
     "SubscriptBox", ",", " ", 
     RowBox[{"and", " ", "SubsuperscriptBox"}]}], "\[IndentingNewLine]", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"makeSpecialSymb", "[", "var_", "]"}], ":=", " ", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "var", ",", "\[IndentingNewLine]", "_SubscriptBox", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ToExpression", "[", "var", "]"}], ",", "\[IndentingNewLine]", 
       "_SubsuperscriptBox", ",", "\[IndentingNewLine]", 
       RowBox[{"ToExpression", "[", "var", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"makeSpecialSymb", "[", 
      RowBox[{"var_String", ",", "i_", ",", "j_"}], "]"}], ":=", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"SubscriptBox", "[", 
       RowBox[{"var", ",", 
        RowBox[{
         RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", "j", "]"}]}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"makeSpecialSymb", "[", 
      RowBox[{"var_SubscriptBox", ",", "i_", ",", "j_"}], "]"}], ":=", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"SubscriptBox", "[", 
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", "j", "]"}]}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"makeSpecialSymb", "[", 
      RowBox[{"var_SuperscriptBox", ",", "i_", ",", "j_"}], "]"}], ":=", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"SubsuperscriptBox", "[", 
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", "j", "]"}]}], ",", 
        RowBox[{"var", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"makeSpecialSymb", "[", 
      RowBox[{"var_SubsuperscriptBox", ",", "i_", ",", "j_"}], "]"}], ":=", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"SubsuperscriptBox", "[", 
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "<>", " ", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", "j", "]"}]}], ",", 
        RowBox[{"var", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], " ", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"makeSpecialSymb", "[", 
      RowBox[{"var_String", ",", "i_"}], "]"}], ":=", " ", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"SubscriptBox", "[", 
       RowBox[{"var", ",", 
        RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"makeSpecialSymb", "[", 
      RowBox[{"var_SubscriptBox", ",", "i_"}], "]"}], ":=", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"SubscriptBox", "[", 
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"makeSpecialSymb", "[", 
      RowBox[{"var_SuperscriptBox", ",", "i_"}], "]"}], ":=", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"SubsuperscriptBox", "[", 
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"ToString", "[", "i", "]"}], ",", 
        RowBox[{"var", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"makeSpecialSymb", "[", 
      RowBox[{"var_SubsuperscriptBox", ",", "i_"}], "]"}], ":=", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"SubsuperscriptBox", "[", 
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "<>", " ", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", "i", "]"}]}], ",", 
        RowBox[{"var", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], " ", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixOfSymbols", "[", 
      RowBox[{"func_Function", ",", "m_Integer", ",", "n_Integer"}], "]"}], ":=",
      "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"func", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "m"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixOfSymbols", "[", 
      RowBox[{"func_Function", ",", "m_Integer"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"func", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "m"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixOfSymbols", "[", 
      RowBox[{"argSpecSymb_", ",", "m_Integer", ",", "n_Integer"}], "]"}], ":=",
      "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"makeSpecialSymb", "[", 
        RowBox[{"argSpecSymb", ",", "i", ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "m"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixOfSymbols", "[", 
      RowBox[{"argSpecSymb_", ",", "m_Integer"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"makeSpecialSymb", "[", 
        RowBox[{"argSpecSymb", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "m"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "setPart", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"setPart", ",", "HoldFirst"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"setPart", "[", 
      RowBox[{"lst_Symbol", ",", "i_", ",", "value_"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"heldPart", "=", 
         RowBox[{"First", "@", 
          RowBox[{"Extract", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Hold", "[", "lst", "]"}], "/.", 
             RowBox[{"OwnValues", "[", "lst", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"1", ",", "i"}], "}"}], "}"}], ",", "Hold"}], "]"}]}]}],
         "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"heldPart", ",", 
           RowBox[{"Hold", "[", "_Symbol", "]"}]}], "]"}], ",", 
         RowBox[{"Set", "@@", 
          RowBox[{"Append", "[", 
           RowBox[{"heldPart", ",", "value"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"lst", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "value"}]}], "]"}]}], "]"}]}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.5933533921228743`*^9, 3.593353402225134*^9}, {
   3.593353439507699*^9, 3.593353449349689*^9}, 3.5933656408702917`*^9, {
   3.593413466384*^9, 3.593413622322384*^9}, 3.593413690467492*^9, {
   3.593413774430134*^9, 3.59341388821795*^9}, {3.5934141304171057`*^9, 
   3.593414132125236*^9}, {3.593416350804923*^9, 3.5934163923068647`*^9}, {
   3.593416580011578*^9, 3.59341664319989*^9}, {3.593416844251369*^9, 
   3.593416850447769*^9}, {3.5934174460079393`*^9, 3.593417446223576*^9}, {
   3.5934180985927763`*^9, 3.593418098988728*^9}, {3.593419018029933*^9, 
   3.59341914892552*^9}, {3.593419684269308*^9, 3.5934197008845863`*^9}, {
   3.593433525287511*^9, 3.593433583066749*^9}, {3.593438477713746*^9, 
   3.5934384780008383`*^9}, {3.593438517577211*^9, 3.593438519463523*^9}, 
   3.59445426083246*^9, {3.5944706189569607`*^9, 3.594470619021504*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["MultiProcessorProx", "Title",
 CellChangeTimes->{{3.593331948744555*^9, 3.593331954946844*^9}, 
   3.5944705713748693`*^9, {3.594470705194116*^9, 3.594470707073296*^9}}],

Cell["\<\

Procedure for 1 Body\
\>", "Subtitle",
 CellChangeTimes->{
  3.5933319616696043`*^9, {3.593332138604823*^9, 3.593332155618638*^9}}],

Cell[CellGroupData[{

Cell["Multiplicity of 1 Body", "Subsection",
 CellChangeTimes->{{3.5933350177917767`*^9, 3.5933350258320436`*^9}}],

Cell["\<\
Multiplicity is the the number of how many times the body has been splitted!
Uncomment nMultiplicity if we use the batch script to generate all \
multiplicity matrices in code form\
\>", "Text",
 CellChangeTimes->{{3.5933325482489157`*^9, 3.593332573077015*^9}, {
  3.5933326116067257`*^9, 3.593332618057022*^9}, {3.596358987219542*^9, 
  3.5963590241959543`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nMultiplicity", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nSplitBodies", " ", "=", " ", "nMultiplicity"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nProcessors", " ", "=", " ", "nMultiplicity"}], ";"}]}], "Input",
 CellChangeTimes->{{3.593332123913176*^9, 3.593332160446104*^9}, {
   3.593332519988473*^9, 3.593332544426105*^9}, {3.593332578154544*^9, 
   3.5933326130331717`*^9}, 3.5944695014202757`*^9, 3.59446962279523*^9, {
   3.594469653221057*^9, 3.594469657647298*^9}, 3.594469737221758*^9, {
   3.5945318137819443`*^9, 3.594531837224019*^9}, 3.594553723409536*^9, 
   3.59455462534303*^9, {3.5945551337694407`*^9, 3.5945551563470497`*^9}, 
   3.594559612688849*^9, 3.594559786206802*^9, 3.594559869804318*^9, {
   3.596358982558556*^9, 3.5963589853902273`*^9}, 3.5963590319296713`*^9, {
   3.596360882537628*^9, 3.596360883636115*^9}, 3.5963609638963623`*^9, {
   3.596448950310774*^9, 3.596448953345191*^9}, {3.596450841236017*^9, 
   3.596450847127687*^9}, {3.596451556513473*^9, 3.596451558219895*^9}, 
   3.5964586503745823`*^9, {3.596800938451392*^9, 3.596800939539754*^9}, 
   3.596801618147382*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Connectivity Matrix", "Subsection",
 CellChangeTimes->{{3.593332225986314*^9, 3.593332270413474*^9}, 
   3.593332620544631*^9, {3.5944497885643177`*^9, 3.59444979009107*^9}}],

Cell["\<\
Tells if i - th and j - th Processor are connected, in general every body is \
connected to every process\
\>", "Text",
 CellChangeTimes->{{3.5933322716547823`*^9, 3.593332278240814*^9}, {
  3.593332488134183*^9, 3.593332506327128*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cm", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], " ", "=", " ", 
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {"1", 
          RowBox[{
           RowBox[{"i", "\[NotEqual]", "j"}], " ", "\[And]", " ", 
           RowBox[{"j", "\[GreaterEqual]", " ", "i", "  "}]}]},
         {"0", "False"},
         {
          RowBox[{"-", "1"}], 
          RowBox[{
           RowBox[{"i", "\[NotEqual]", "j"}], " ", "\[And]", " ", 
           RowBox[{"j", "\[LessEqual]", "  ", "i", "  "}]}]}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}},
        Selectable->True]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CM", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"cm", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nSplitBodies"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nSplitBodies"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Det[CM]: \>\"", " ", ",", " ", 
   RowBox[{"Det", "[", "CM", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<CM:\>\"", ",", 
   RowBox[{"CM", " ", "//", "MyMatrixStyle"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5933321123427887`*^9, 3.5933321211609697`*^9}, {
   3.593332171070125*^9, 3.59333222216835*^9}, {3.593332283428294*^9, 
   3.593332302302843*^9}, {3.5933323442773333`*^9, 3.593332344626903*^9}, {
   3.593332403582117*^9, 3.593332480884515*^9}, {3.593332597534751*^9, 
   3.593332598487247*^9}, {3.593332903147583*^9, 3.593332909529957*^9}, {
   3.593333154622216*^9, 3.593333155244546*^9}, 3.593334141890786*^9, {
   3.5933342182389393`*^9, 3.593334276102401*^9}, {3.593342817575803*^9, 
   3.593342820287857*^9}, {3.594451059487028*^9, 3.594451080899612*^9}, {
   3.596449086234601*^9, 3.596449104460906*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Det[CM]: \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["Det[CM]: ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.596449054305708*^9, 3.596449131058383*^9}, 
   3.596449265385126*^9, 3.596449571618194*^9, 3.596451560113742*^9, 
   3.596800943054697*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"CM:\"\>", "\[InvisibleSpace]", 
   FrameBox[
    StyleBox[
     TagBox[GridBox[{
        {"0", "1", "1", "1"},
        {
         RowBox[{"-", "1"}], "0", "1", "1"},
        {
         RowBox[{"-", "1"}], 
         RowBox[{"-", "1"}], "0", "1"},
        {
         RowBox[{"-", "1"}], 
         RowBox[{"-", "1"}], 
         RowBox[{"-", "1"}], "0"}
       },
       AutoDelete->False,
       FrameStyle->{
         Thickness[0.1]},
       GridBoxDividers->{
        "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"],
     StripOnInput->False,
     FontWeight->Bold],
    RoundingRadius->1,
    StripOnInput->False]}],
  SequenceForm["CM:", 
   $CellContext`MyMatrixStyle[{{0, 1, 1, 1}, {-1, 0, 1, 1}, {-1, -1, 0, 
    1}, {-1, -1, -1, 0}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.596449054305708*^9, 3.596449131058383*^9}, 
   3.596449265385126*^9, 3.596449571618194*^9, 3.596451560113742*^9, 
   3.596800943106016*^9}]
}, Open  ]]
}, Open  ]],

Cell["\<\
To make G not singular at the end (body i to body j in increasing order, e.g \
1-2, 2-3 3-4 :\
\>", "Text",
 CellChangeTimes->{{3.5944558220397053`*^9, 3.594455843947927*^9}, {
  3.594455896789983*^9, 3.594455927138603*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cm", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], " ", "=", " ", 
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {"1", 
          RowBox[{"i", "\[Equal]", 
           RowBox[{"j", " ", "-", "1", " "}]}]},
         {"0", "False"},
         {
          RowBox[{"-", "1"}], 
          RowBox[{
           RowBox[{"i", "-", "1"}], "\[Equal]", "j", "  "}]}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}},
        Selectable->True]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CM", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"cm", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nSplitBodies"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nSplitBodies"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Det[CM]: \>\"", " ", ",", " ", 
   RowBox[{"Det", "[", "CM", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<CM:\>\"", ",", 
   RowBox[{"CM", " ", "//", "MyMatrixStyle"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.594455948091057*^9, 3.5944560606487923`*^9}, {
  3.5944561048729963`*^9, 3.5944561069507227`*^9}, {3.5964491139613523`*^9, 
  3.596449127923563*^9}, {3.596449419623233*^9, 3.596449420677504*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Det[CM]: \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["Det[CM]: ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.596449421241297*^9, 3.596449571684416*^9, 
  3.5964515601664743`*^9, 3.5968009431747103`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"CM:\"\>", "\[InvisibleSpace]", 
   FrameBox[
    StyleBox[
     TagBox[GridBox[{
        {"0", "1", "0", "0"},
        {
         RowBox[{"-", "1"}], "0", "1", "0"},
        {"0", 
         RowBox[{"-", "1"}], "0", "1"},
        {"0", "0", 
         RowBox[{"-", "1"}], "0"}
       },
       AutoDelete->False,
       FrameStyle->{
         Thickness[0.1]},
       GridBoxDividers->{
        "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"],
     StripOnInput->False,
     FontWeight->Bold],
    RoundingRadius->1,
    StripOnInput->False]}],
  SequenceForm["CM:", 
   $CellContext`MyMatrixStyle[{{0, 1, 0, 0}, {-1, 0, 1, 0}, {0, -1, 0, 1}, {0,
     0, -1, 0}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.596449421241297*^9, 3.596449571684416*^9, 
  3.5964515601664743`*^9, 3.596800943176632*^9}]
}, Open  ]]
}, Open  ]],

Cell["\<\
Make a connecting loop, first to last body also connected! (Does not work G \
gets singular as well)\
\>", "Text",
 CellChangeTimes->{{3.5944558220397053`*^9, 3.594455843947927*^9}, {
  3.594455896789983*^9, 3.594455927138603*^9}, {3.5964494706419992`*^9, 
  3.5964495129188347`*^9}, {3.596450820642297*^9, 3.5964508289982567`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"CM", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "nSplitBodies"}], "]"}], "]"}], " ", "=", " ", "1"}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CM", "[", 
     RowBox[{"[", 
      RowBox[{"nSplitBodies", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<CM:\>\"", ",", 
      RowBox[{"CM", " ", "//", "MyMatrixStyle"}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Det[CM]: \>\"", " ", ",", " ", 
      RowBox[{"Det", "[", "CM", "]"}]}], "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{
  3.5964494635663548`*^9, {3.596449518342402*^9, 3.596449564015966*^9}, {
   3.596449887145709*^9, 3.596449887310978*^9}, 3.596450833476246*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.594455845083838*^9, 3.59445584553793*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
How many multiplicity constraints do we have?\
\>", "Subsection",
 CellChangeTimes->{{3.5933326674486094`*^9, 3.593332682648031*^9}, {
  3.593333570864895*^9, 3.5933335732644367`*^9}, {3.593334962656736*^9, 
  3.593334964820796*^9}}],

Cell[TextData[{
 "Count the number of connections in the upper part of the connectivity \
matrix.\nOr ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"nSplitBodies"},
       {"2"}
      }], ")"}], "=", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"nSplitBodies", "^", "2"}], " ", "-", " ", "nSplitBodies"}], 
      ")"}], "2"]}], TraditionalForm]]],
 " combinations, every body with every body."
}], "Text",
 CellChangeTimes->{{3.5933326872206593`*^9, 3.5933327341376543`*^9}, {
  3.593332861124401*^9, 3.593332891890242*^9}, {3.593333040315737*^9, 
  3.593333100398759*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"nMConstraint", " ", "=", " ", 
  RowBox[{"Count", "[", 
   RowBox[{"CM", ",", "1", ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<nMConstraint:\>\"", ",", 
   RowBox[{"nMConstraint", " ", "//", "MatrixForm"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.593332735661261*^9, 3.593332778191571*^9}, {
   3.593332847676104*^9, 3.5933328582517033`*^9}, {3.593332893772043*^9, 
   3.593332921709179*^9}, 3.5933329646297827`*^9, {3.594456300580785*^9, 
   3.594456309387425*^9}, {3.594456361443206*^9, 3.5944563618713627`*^9}}],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{3.5964490544238043`*^9, 3.59644913333241*^9, 
  3.596449265537385*^9, 3.596449571836623*^9, 3.596449903271674*^9, 
  3.5964515602411823`*^9, 3.596800943266872*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nMConstraint:\"\>", "\[InvisibleSpace]", 
   TagBox["3",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["nMConstraint:", 
   MatrixForm[3]],
  Editable->False]], "Print",
 CellChangeTimes->{3.596449054425413*^9, 3.5964491333341827`*^9, 
  3.596449265539836*^9, 3.596449571838265*^9, 3.5964499032742987`*^9, 
  3.5964515602433987`*^9, 3.596800943269038*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"listMConst", " ", "=", " ", 
     RowBox[{"Select", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"Range", "[", "nSplitBodies", "]"}], ",", "2"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"CM", "[", 
          RowBox[{"[", " ", 
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#1", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}], "]"}], "\[Equal]", 
         "1"}], "&"}]}], "  ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"listMConst", "=", 
    RowBox[{"Sort", "[", 
     RowBox[{"listMConst", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"Differences", "[", "#1", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "<=", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"Differences", "[", "#2", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
       "&"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<List of Constraints from Body i to Body j:\>\"", ",", 
      "listMConst"}], " ", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.593333611662724*^9, 3.593333682081375*^9}, {
   3.5933337357180367`*^9, 3.5933337370517693`*^9}, {3.593333819764752*^9, 
   3.593333874829804*^9}, {3.593333906438937*^9, 3.59333390986963*^9}, {
   3.593334010151546*^9, 3.5933340715534067`*^9}, {3.593334104849681*^9, 
   3.593334107685853*^9}, 3.593334152793352*^9, {3.5933342951305637`*^9, 
   3.593334297198954*^9}, {3.5933344234159603`*^9, 3.593334459518474*^9}, 
   3.593334501792121*^9, {3.593334577962192*^9, 3.5933346633568687`*^9}, {
   3.596449978470406*^9, 3.5964500038707237`*^9}, {3.596450037293548*^9, 
   3.596450037881873*^9}, {3.596450094368379*^9, 3.596450108440213*^9}, {
   3.59645013924409*^9, 3.596450202257563*^9}, {3.59645028270265*^9, 
   3.5964503341165524`*^9}, {3.596450511719913*^9, 3.5964505557618113`*^9}, {
   3.596450596372286*^9, 3.5964507082019777`*^9}, {3.5964507604653597`*^9, 
   3.596450761214262*^9}, 3.5968010320797043`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.596450599008977*^9, 3.596450647421467*^9}, {
   3.596450677615305*^9, 3.5964507218831673`*^9}, 3.596450761868226*^9, 
   3.596451560296482*^9, 3.5968009433629227`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"List of Constraints from Body i to Body j:\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}],
  SequenceForm[
  "List of Constraints from Body i to Body j:", {{1, 2}, {2, 3}, {3, 4}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5964490544871473`*^9, 3.59644913527188*^9, 3.5964492655966463`*^9, 
   3.596449571911627*^9, 3.5964499093990107`*^9, 3.59645000644742*^9, 
   3.596450038251822*^9, 3.596450109023209*^9, {3.5964503272566977`*^9, 
   3.596450334520666*^9}, {3.596450512119506*^9, 3.596450512856909*^9}, 
   3.5964505570488377`*^9, {3.596450596832919*^9, 3.596450647414247*^9}, {
   3.596450677568285*^9, 3.596450721886224*^9}, 3.596450761871026*^9, 
   3.596451560298642*^9, 3.596800943364912*^9}]
}, Open  ]],

Cell[TextData[{
 "Constraint ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"c", "\[Element]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "...", ",", "nMConstraint"}], "}"}]}],
    FontWeight->"Bold"], TraditionalForm]]],
 " belongs to the connection ",
 StyleBox["listMConst[[c]]",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.5933346923993683`*^9, 3.5933348268810472`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Set up the Dynamics Matrices for these splitted bodies", "Subsection",
 CellChangeTimes->{{3.5933349368275642`*^9, 3.593334995614012*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubsuperscriptBox["u", "G", "S"], "=", 
   RowBox[{"MatrixOfSymbols", "[", 
    RowBox[{
     RowBox[{"SuperscriptBox", "[", 
      RowBox[{"\"\<u\>\"", ",", "\"\<S\>\""}], "]"}], ",", "nSplitBodies"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubsuperscriptBox["u", "G", "E"], "=", 
   RowBox[{"MatrixOfSymbols", "[", 
    RowBox[{
     RowBox[{"SuperscriptBox", "[", 
      RowBox[{"\"\<u\>\"", ",", "\"\<E\>\""}], "]"}], ",", "nSplitBodies"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Vector \!\(\*SubsuperscriptBox[\(u\), \(G\), \(S\)]\): \>\"", ",", 
    RowBox[{
     SubsuperscriptBox["u", "G", "S"], " ", "//", "MyMatrixStyle"}]}], " ", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.59335929250741*^9, 3.5933593269608793`*^9}, {
   3.5933593711832037`*^9, 3.5933593714834843`*^9}, {3.5934164105908823`*^9, 
   3.593416445822319*^9}, {3.593416528949473*^9, 3.593416530154735*^9}, 
   3.593416753822359*^9, {3.593416790766714*^9, 3.5934167936441*^9}, {
   3.593418748145549*^9, 3.593418754931383*^9}, {3.593433414964713*^9, 
   3.593433492796859*^9}, {3.593433612107777*^9, 3.5934337021166677`*^9}, {
   3.5944706190513477`*^9, 3.594470619055872*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Vector \\!\\(\\*SubsuperscriptBox[\\(u\\), \\(G\\), \
\\(S\\)]\\): \"\>", "\[InvisibleSpace]", 
   FrameBox[
    StyleBox[
     TagBox[GridBox[{
        {
         SubsuperscriptBox["u", "1", "S"]},
        {
         SubsuperscriptBox["u", "2", "S"]},
        {
         SubsuperscriptBox["u", "3", "S"]},
        {
         SubsuperscriptBox["u", "4", "S"]}
       },
       AutoDelete->False,
       FrameStyle->{
         Thickness[0.1]},
       GridBoxDividers->{
        "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"],
     StripOnInput->False,
     FontWeight->Bold],
    RoundingRadius->1,
    StripOnInput->False]}],
  SequenceForm["Vector \!\(\*SubsuperscriptBox[\(u\), \(G\), \(S\)]\): ", 
   $CellContext`MyMatrixStyle[{{$CellContext`u\[UnderBracket]Subsuperscript\
\[UnderBracket]1\[UnderBracket]and\[UnderBracket]S}, {$CellContext`u\
\[UnderBracket]Subsuperscript\[UnderBracket]2\[UnderBracket]and\[UnderBracket]\
S}, {$CellContext`u\[UnderBracket]Subsuperscript\[UnderBracket]3\
\[UnderBracket]and\[UnderBracket]S}, \
{$CellContext`u\[UnderBracket]Subsuperscript\[UnderBracket]4\[UnderBracket]\
and\[UnderBracket]S}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.5964490545426493`*^9, 3.596449138107375*^9, 
  3.596449265657205*^9, 3.596449571982174*^9, 3.596450723334063*^9, 
  3.596450764225523*^9, 3.5964515603551683`*^9, 3.596800943552991*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["M", "G"], "=", 
   RowBox[{"MatrixOfSymbols", "[", 
    RowBox[{
     RowBox[{
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {
             RowBox[{"makeSpecialSymb", "[", 
              RowBox[{"\"\<M\>\"", ",", "#1"}], "]"}], 
             RowBox[{"#1", "\[Equal]", "#2"}]},
            {"0", "False"}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}},
           Selectable->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False], "&"}], ",", "nSplitBodies", ",", "nSplitBodies"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Massmatrix \!\(\*SubscriptBox[\(M\), \(G\)]\): \>\"", ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["M", "G"], "\[Transpose]"}], " ", "//", 
     "MyMatrixStyle"}]}], " ", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.593337858059223*^9, 3.5933378587637*^9}, 
   3.5933379195890627`*^9, {3.593337999291317*^9, 3.59333800936217*^9}, {
   3.5933382118077583`*^9, 3.593338217958284*^9}, {3.593338488506236*^9, 
   3.593338489715741*^9}, {3.593339503714375*^9, 3.5933395084330263`*^9}, {
   3.59333954468433*^9, 3.5933395741038303`*^9}, {3.593339657822578*^9, 
   3.593339661484589*^9}, 3.5933402178231573`*^9, {3.593340362598197*^9, 
   3.593340404594784*^9}, {3.5933404472106333`*^9, 3.593340517935577*^9}, 
   3.593342874138218*^9, 3.593343178939953*^9, {3.593358932073647*^9, 
   3.593358966880086*^9}, {3.593359008462944*^9, 3.593359087782785*^9}, {
   3.5933591196357327`*^9, 3.593359168812454*^9}, {3.593416831660996*^9, 
   3.593416832007351*^9}, {3.593416864283608*^9, 3.593416864919817*^9}, {
   3.5934169129774227`*^9, 3.593416917087199*^9}, {3.59341698824339*^9, 
   3.593417093817617*^9}, {3.593433664847888*^9, 3.593433671676361*^9}, 
   3.594470619062334*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Massmatrix \\!\\(\\*SubscriptBox[\\(M\\), \\(G\\)]\\): \"\>", 
   "\[InvisibleSpace]", 
   FrameBox[
    StyleBox[
     TagBox[GridBox[{
        {
         SubscriptBox["M", "1"], "0", "0", "0"},
        {"0", 
         SubscriptBox["M", "2"], "0", "0"},
        {"0", "0", 
         SubscriptBox["M", "3"], "0"},
        {"0", "0", "0", 
         SubscriptBox["M", "4"]}
       },
       AutoDelete->False,
       FrameStyle->{
         Thickness[0.1]},
       GridBoxDividers->{
        "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"],
     StripOnInput->False,
     FontWeight->Bold],
    RoundingRadius->1,
    StripOnInput->False]}],
  SequenceForm["Massmatrix \!\(\*SubscriptBox[\(M\), \(G\)]\): ", 
   $CellContext`MyMatrixStyle[{{$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]1, 0, 0, 0}, {
     0, $CellContext`M\[UnderBracket]Subscript\[UnderBracket]2, 0, 0}, {
     0, 0, $CellContext`M\[UnderBracket]Subscript\[UnderBracket]3, 0}, {
     0, 0, 0, $CellContext`M\[UnderBracket]Subscript\[UnderBracket]4}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.596449054600102*^9, 3.596449139743582*^9, 
  3.596449265705126*^9, 3.596449572053865*^9, 3.5964507246063843`*^9, 
  3.596451560411161*^9, 3.5968009437062387`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["h", "G"], "=", " ", 
   RowBox[{"MatrixOfSymbols", "[", 
    RowBox[{"\"\<h\>\"", ",", "nSplitBodies"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Vector \!\(\*SubscriptBox[\(h\), \(G\)]\): \>\"", ",", 
   RowBox[{
    SubscriptBox["h", "G"], " ", "//", "MyMatrixStyle"}]}], " ", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.593340438465427*^9, {3.593340568914843*^9, 3.593340627667386*^9}, 
   3.593342875267708*^9, {3.593359190706881*^9, 3.5933591967352953`*^9}, {
   3.59341693819866*^9, 3.5934169391103354`*^9}, {3.593433688535969*^9, 
   3.593433694420485*^9}, 3.594470619067566*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Vector \\!\\(\\*SubscriptBox[\\(h\\), \\(G\\)]\\): \"\>", 
   "\[InvisibleSpace]", 
   FrameBox[
    StyleBox[
     TagBox[GridBox[{
        {
         SubscriptBox["h", "1"]},
        {
         SubscriptBox["h", "2"]},
        {
         SubscriptBox["h", "3"]},
        {
         SubscriptBox["h", "4"]}
       },
       AutoDelete->False,
       FrameStyle->{
         Thickness[0.1]},
       GridBoxDividers->{
        "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"],
     StripOnInput->False,
     FontWeight->Bold],
    RoundingRadius->1,
    StripOnInput->False]}],
  SequenceForm["Vector \!\(\*SubscriptBox[\(h\), \(G\)]\): ", 
   $CellContext`MyMatrixStyle[{{$CellContext`h\[UnderBracket]Subscript\
\[UnderBracket]1}, {$CellContext`h\[UnderBracket]Subscript\[UnderBracket]2}, \
{$CellContext`h\[UnderBracket]Subscript\[UnderBracket]3}, {$CellContext`h\
\[UnderBracket]Subscript\[UnderBracket]4}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.5964490546533003`*^9, 3.596449140992798*^9, 
  3.5964492657565928`*^9, 3.596449572123241*^9, 3.5964507255968037`*^9, 
  3.596451560463676*^9, 3.596800943940878*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["W", "L"], "=", " ", 
    RowBox[{"MatrixOfSymbols", "[", 
     RowBox[{
      RowBox[{
       TagBox[GridBox[{
          {"\[Piecewise]", GridBox[{
             {
              RowBox[{"makeSpecialSymb", "[", 
               RowBox[{
                RowBox[{"SubscriptBox", "[", 
                 RowBox[{"\"\<W\>\"", ",", "\"\<loc\>\""}], "]"}], ",", 
                "#1"}], "]"}], 
              RowBox[{"#1", "\[Equal]", " ", "#2", " "}]},
             {"0", "False"}
            },
            AllowedDimensions->{2, Automatic},
            Editable->True,
            
            GridBoxAlignment->{
             "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{1.}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.84]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}},
            Selectable->True]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.35]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        "Piecewise",
        DeleteWithContents->True,
        Editable->False,
        SelectWithContents->True,
        Selectable->False], "&"}], ",", "nSplitBodies", ",", "nSplitBodies"}],
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[CapitalLambda]", "L"], "=", 
    RowBox[{"MatrixOfSymbols", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"makeSpecialSymb", "[", 
        RowBox[{
         RowBox[{"SubscriptBox", "[", 
          RowBox[{"\"\<\[CapitalLambda]\>\"", ",", "\"\<loc\>\""}], "]"}], 
         ",", "#1"}], "]"}], "&"}], ",", "nSplitBodies"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Total local \!\(\*SubscriptBox[\(W\), \(G\)]\) (all process local \
contacts): \\n  \!\(\*SubscriptBox[\(W\), \(G\)]\).\!\(\*SubscriptBox[\(\
\[CapitalLambda]\), \(G\)]\): \>\"", ",", 
   RowBox[{
    SubscriptBox["W", "L"], " ", "//", "MyMatrixStyle"}], " ", ",", 
   "\"\<.\>\"", ",", " ", 
   RowBox[{
    SubscriptBox["\[CapitalLambda]", "L"], "//", "MyMatrixStyle"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.5933406329658527`*^9, 3.593340765082806*^9}, {
   3.593340797829768*^9, 3.593340896511704*^9}, {3.593341029070692*^9, 
   3.5933410918206472`*^9}, {3.593341305115919*^9, 3.59334131658008*^9}, {
   3.593341545241064*^9, 3.593341545670547*^9}, {3.593342876518606*^9, 
   3.593342878650488*^9}, 3.59334295783256*^9, {3.593344285234325*^9, 
   3.593344358144898*^9}, {3.5933446038606997`*^9, 3.5933446084245977`*^9}, {
   3.59334496586618*^9, 3.593344979030645*^9}, {3.593345011411055*^9, 
   3.593345022929365*^9}, {3.593345075718113*^9, 3.593345148115748*^9}, {
   3.593359384303959*^9, 3.5933594370302553`*^9}, 3.593359497409959*^9, {
   3.593359536033654*^9, 3.593359562612052*^9}, {3.593359699884803*^9, 
   3.593359760447712*^9}, {3.593359871386693*^9, 3.593359876767961*^9}, {
   3.59335990772022*^9, 3.593359914861792*^9}, {3.593359983623448*^9, 
   3.593360030201948*^9}, {3.59336023210616*^9, 3.59336024030359*^9}, {
   3.593360286216357*^9, 3.593360289901764*^9}, {3.593360381783416*^9, 
   3.593360383742498*^9}, {3.593360467782007*^9, 3.593360482142935*^9}, {
   3.593417109964636*^9, 3.593417185683419*^9}, 3.593433850916273*^9, {
   3.5934403384050627`*^9, 3.593440352238055*^9}, 3.5934404119397097`*^9, {
   3.594470619073938*^9, 3.5944706190791903`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total local \\!\\(\\*SubscriptBox[\\(W\\), \\(G\\)]\\) (all \
process local contacts): \\n  \\!\\(\\*SubscriptBox[\\(W\\), \
\\(G\\)]\\).\\!\\(\\*SubscriptBox[\\(\[CapitalLambda]\\), \\(G\\)]\\): \"\>", 
   "\[InvisibleSpace]", 
   FrameBox[
    StyleBox[
     TagBox[GridBox[{
        {
         SubscriptBox["W", 
          RowBox[{"loc", ",", "1"}]], "0", "0", "0"},
        {"0", 
         SubscriptBox["W", 
          RowBox[{"loc", ",", "2"}]], "0", "0"},
        {"0", "0", 
         SubscriptBox["W", 
          RowBox[{"loc", ",", "3"}]], "0"},
        {"0", "0", "0", 
         SubscriptBox["W", 
          RowBox[{"loc", ",", "4"}]]}
       },
       AutoDelete->False,
       FrameStyle->{
         Thickness[0.1]},
       GridBoxDividers->{
        "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"],
     StripOnInput->False,
     FontWeight->Bold],
    RoundingRadius->1,
    StripOnInput->False], "\[InvisibleSpace]", "\<\".\"\>", 
   "\[InvisibleSpace]", 
   FrameBox[
    StyleBox[
     TagBox[GridBox[{
        {
         SubscriptBox["\[CapitalLambda]", 
          RowBox[{"loc", ",", "1"}]]},
        {
         SubscriptBox["\[CapitalLambda]", 
          RowBox[{"loc", ",", "2"}]]},
        {
         SubscriptBox["\[CapitalLambda]", 
          RowBox[{"loc", ",", "3"}]]},
        {
         SubscriptBox["\[CapitalLambda]", 
          RowBox[{"loc", ",", "4"}]]}
       },
       AutoDelete->False,
       FrameStyle->{
         Thickness[0.1]},
       GridBoxDividers->{
        "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"],
     StripOnInput->False,
     FontWeight->Bold],
    RoundingRadius->1,
    StripOnInput->False]}],
  SequenceForm[
  "Total local \!\(\*SubscriptBox[\(W\), \(G\)]\) (all process local \
contacts): \n  \!\(\*SubscriptBox[\(W\), \(G\)]\).\!\(\*SubscriptBox[\(\
\[CapitalLambda]\), \(G\)]\): ", 
   $CellContext`MyMatrixStyle[{{$CellContext`W\[UnderBracket]Subscript\
\[UnderBracket]loc\[UnderBracket]Comma\[UnderBracket]1, 0, 0, 0}, {
     0, $CellContext`W\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]2, 0, 0}, {
     0, 0, $CellContext`W\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]3, 0}, {
     0, 0, 0, $CellContext`W\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]4}}], ".", 
   $CellContext`MyMatrixStyle[{{$CellContext`\[CapitalLambda]\[UnderBracket]\
Subscript\[UnderBracket]loc\[UnderBracket]Comma\[UnderBracket]1}, \
{$CellContext`\[CapitalLambda]\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]2}, {$CellContext`\[CapitalLambda]\
\[UnderBracket]Subscript\[UnderBracket]loc\[UnderBracket]Comma\[UnderBracket]\
3}, {$CellContext`\[CapitalLambda]\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]4}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.596449054711544*^9, {3.596449142295648*^9, 3.5964491443971243`*^9}, 
   3.5964492657983913`*^9, 3.596449572188807*^9, {3.596450726522827*^9, 
   3.596450728150638*^9}, 3.596450765831318*^9, 3.596451560521059*^9, 
   3.5968009441232643`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.593440359143098*^9, 3.593440364438919*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"The", " ", "actual", " ", "W"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["W", 
      RowBox[{"M", " "}]], "=", 
     RowBox[{"MatrixOfSymbols", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"makeSpecialSymb", "[", 
         RowBox[{
          RowBox[{"SubscriptBox", "[", 
           RowBox[{"\"\<W\>\"", ",", "\"\<mul\>\""}], "]"}], ",", "#2"}], 
         "]"}], "&"}], ",", "1", ",", "nMConstraint"}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "the", " ", 
     SubscriptBox["W", 
      RowBox[{"mul", ",", "i"}]], " ", "terms", " ", "by", " ", 
     "replacement"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listWmuli", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      SubscriptBox["W", "M"], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"setW", "[", "k_", "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       TagBox[GridBox[{
          {"\[Piecewise]", GridBox[{
             {"Id", 
              RowBox[{
               RowBox[{"listMConst", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "1"}], "]"}], "]"}], "\[Equal]", "i"}]},
             {
              RowBox[{"-", "Id"}], 
              RowBox[{
               RowBox[{"listMConst", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "2"}], "]"}], "]"}], "\[Equal]", "i"}]}
            },
            AllowedDimensions->{2, Automatic},
            Editable->True,
            
            GridBoxAlignment->{
             "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{1.}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.84]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}},
            Selectable->True]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.35]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        "Piecewise",
        DeleteWithContents->True,
        Editable->False,
        SelectWithContents->True,
        Selectable->False], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nSplitBodies"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"repWmul", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"listWmuli", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], " ", "\[Rule]", " ", 
         RowBox[{"setW", "[", "#1", "]"}]}], ")"}], "&"}], " ", "/@", 
      RowBox[{"Range", "[", "nMConstraint", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["W", 
      RowBox[{"M", ",", "rep"}]], " ", "=", " ", 
     RowBox[{"ExpandMatrix", "[", 
      RowBox[{
       SubscriptBox["W", "M"], "/.", " ", "repWmul"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.5933422815478888`*^9, 3.593342427159927*^9}, {
   3.593342529538176*^9, 3.593342547706025*^9}, {3.593342649998082*^9, 
   3.593342786148644*^9}, {3.5933429645179377`*^9, 3.5933430220020638`*^9}, {
   3.593343196052266*^9, 3.593343197812345*^9}, {3.593343302285426*^9, 
   3.5933433540412397`*^9}, {3.593344112163796*^9, 3.5933441675510817`*^9}, {
   3.593344200963011*^9, 3.593344242476842*^9}, {3.593344568834126*^9, 
   3.593344619275674*^9}, 3.593345069833119*^9, {3.59334515615268*^9, 
   3.5933451605346727`*^9}, {3.593345806479163*^9, 3.593345986972541*^9}, {
   3.593346044026086*^9, 3.593346071229068*^9}, {3.593346117487111*^9, 
   3.593346141446306*^9}, {3.593346250877014*^9, 3.593346255976777*^9}, 
   3.593353263539131*^9, {3.59335329752831*^9, 3.5933533558998327`*^9}, {
   3.593353456005546*^9, 3.593353458978262*^9}, {3.593360571512392*^9, 
   3.59336067104598*^9}, {3.5933607673531017`*^9, 3.593360816504171*^9}, 
   3.593365915055921*^9, {3.593365954588529*^9, 3.593365955014359*^9}, {
   3.5933660085912113`*^9, 3.593366009053581*^9}, {3.593417231643317*^9, 
   3.593417292928691*^9}, {3.593417332557767*^9, 3.5934174038308268`*^9}, {
   3.5934174876660852`*^9, 3.593417516670272*^9}, {3.5934175964191933`*^9, 
   3.593417865184354*^9}, {3.593417987554604*^9, 3.593418077646297*^9}, {
   3.593418140427783*^9, 3.5934183171630077`*^9}, {3.5934183566880817`*^9, 
   3.5934183996394777`*^9}, {3.593418430390645*^9, 3.59341855486467*^9}, 
   3.59341859220919*^9, {3.593419226152845*^9, 3.593419275334588*^9}, {
   3.593419309250437*^9, 3.5934193203358603`*^9}, {3.593425501163877*^9, 
   3.593425503738214*^9}, {3.593431734787669*^9, 3.593431834188308*^9}, {
   3.593431902824637*^9, 3.5934319987027693`*^9}, {3.593432131858897*^9, 
   3.593432157607696*^9}, {3.5934322006396627`*^9, 3.593432250669112*^9}, {
   3.5934322835436068`*^9, 3.593432418995872*^9}, {3.59343245046741*^9, 
   3.593432482055578*^9}, {3.593432518471923*^9, 3.593432547111521*^9}, {
   3.5934326066727657`*^9, 3.5934326822855997`*^9}, {3.593432715269568*^9, 
   3.593432718997633*^9}, 3.59343277393887*^9, {3.593432820493228*^9, 
   3.593432931133008*^9}, {3.593433129566867*^9, 3.593433221692643*^9}, {
   3.593433315239812*^9, 3.5934333239337606`*^9}, {3.593440368727132*^9, 
   3.593440393647338*^9}, 3.594449881522554*^9, {3.594449972415717*^9, 
   3.5944499832244873`*^9}, 3.594470619086998*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[CapitalLambda]", "M"], "=", 
    RowBox[{"MatrixOfSymbols", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"makeSpecialSymb", "[", 
        RowBox[{
         RowBox[{"SubscriptBox", "[", 
          RowBox[{"\"\<\[CapitalLambda]\>\"", ",", "\"\<mul\>\""}], "]"}], 
         ",", "#1"}], "]"}], "&"}], ",", "nMConstraint"}], "]"}]}], " ", 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Total multiplicity \\n \!\(\*SubscriptBox[\(W\), \
\(M\)]\).\!\(\*SubscriptBox[\(\[CapitalLambda]\), \(M\)]\): \>\"", ",", " ", 
   RowBox[{
    SubscriptBox["W", "M"], " ", "//", "MyMatrixStyle"}], " ", ",", 
   "\"\<.\>\"", ",", " ", 
   RowBox[{
    SubscriptBox["\[CapitalLambda]", "M"], "//", "MyMatrixStyle"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<\!\(\*SubscriptBox[\(W\), \(M\)]\).\!\(\*SubscriptBox[\(\
\[CapitalLambda]\), \(M\)]\): \>\"", ",", " ", 
   RowBox[{
    SubscriptBox["W", 
     RowBox[{"M", ",", "rep"}]], "//", "MyMatrixStyle"}], " ", ",", 
   "\"\<.\>\"", ",", " ", 
   RowBox[{
    SubscriptBox["\[CapitalLambda]", "M"], "//", "MyMatrixStyle"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.5933422815478888`*^9, 3.593342427159927*^9}, {
   3.593342529538176*^9, 3.593342547706025*^9}, {3.593342649998082*^9, 
   3.593342786148644*^9}, {3.5933429645179377`*^9, 3.5933430220020638`*^9}, {
   3.593343196052266*^9, 3.593343197812345*^9}, {3.593343302285426*^9, 
   3.5933433540412397`*^9}, {3.593344112163796*^9, 3.5933441675510817`*^9}, {
   3.593344200963011*^9, 3.593344242476842*^9}, {3.593344568834126*^9, 
   3.593344619275674*^9}, 3.593345069833119*^9, {3.59334515615268*^9, 
   3.5933451605346727`*^9}, {3.593345806479163*^9, 3.593345986972541*^9}, {
   3.593346044026086*^9, 3.593346071229068*^9}, {3.593346117487111*^9, 
   3.593346141446306*^9}, {3.593346250877014*^9, 3.593346255976777*^9}, 
   3.593353263539131*^9, {3.59335329752831*^9, 3.5933533558998327`*^9}, {
   3.593353456005546*^9, 3.593353458978262*^9}, {3.593360571512392*^9, 
   3.59336067104598*^9}, {3.5933607673531017`*^9, 3.593360816504171*^9}, 
   3.593365915055921*^9, {3.593365954588529*^9, 3.593365955014359*^9}, {
   3.5933660085912113`*^9, 3.593366009053581*^9}, {3.593417231643317*^9, 
   3.593417292928691*^9}, {3.593417332557767*^9, 3.5934174038308268`*^9}, {
   3.5934174876660852`*^9, 3.593417516670272*^9}, {3.5934175964191933`*^9, 
   3.593417865184354*^9}, {3.593417987554604*^9, 3.593418077646297*^9}, {
   3.593418140427783*^9, 3.5934182326504593`*^9}, {3.593432083358165*^9, 
   3.5934321050541058`*^9}, {3.593433277252947*^9, 3.593433293828854*^9}, {
   3.593433380827388*^9, 3.59343338575533*^9}, 3.59344039811404*^9, {
   3.594449961829488*^9, 3.5944499650611057`*^9}, 3.5944706190930643`*^9, 
   3.596345331090596*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total multiplicity \\n \\!\\(\\*SubscriptBox[\\(W\\), \\(M\\)]\
\\).\\!\\(\\*SubscriptBox[\\(\[CapitalLambda]\\), \\(M\\)]\\): \"\>", 
   "\[InvisibleSpace]", 
   FrameBox[
    StyleBox[
     TagBox[GridBox[{
        {
         SubscriptBox["W", 
          RowBox[{"mul", ",", "1"}]], 
         SubscriptBox["W", 
          RowBox[{"mul", ",", "2"}]], 
         SubscriptBox["W", 
          RowBox[{"mul", ",", "3"}]]}
       },
       AutoDelete->False,
       FrameStyle->{
         Thickness[0.1]},
       GridBoxDividers->{
        "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"],
     StripOnInput->False,
     FontWeight->Bold],
    RoundingRadius->1,
    StripOnInput->False], "\[InvisibleSpace]", "\<\".\"\>", 
   "\[InvisibleSpace]", 
   FrameBox[
    StyleBox[
     TagBox[GridBox[{
        {
         SubscriptBox["\[CapitalLambda]", 
          RowBox[{"mul", ",", "1"}]]},
        {
         SubscriptBox["\[CapitalLambda]", 
          RowBox[{"mul", ",", "2"}]]},
        {
         SubscriptBox["\[CapitalLambda]", 
          RowBox[{"mul", ",", "3"}]]}
       },
       AutoDelete->False,
       FrameStyle->{
         Thickness[0.1]},
       GridBoxDividers->{
        "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"],
     StripOnInput->False,
     FontWeight->Bold],
    RoundingRadius->1,
    StripOnInput->False]}],
  SequenceForm[
  "Total multiplicity \n \!\(\*SubscriptBox[\(W\), \
\(M\)]\).\!\(\*SubscriptBox[\(\[CapitalLambda]\), \(M\)]\): ", 
   $CellContext`MyMatrixStyle[{{$CellContext`W\[UnderBracket]Subscript\
\[UnderBracket]mul\[UnderBracket]Comma\[UnderBracket]1, $CellContext`W\
\[UnderBracket]Subscript\[UnderBracket]mul\[UnderBracket]Comma\[UnderBracket]\
2, $CellContext`W\[UnderBracket]Subscript\[UnderBracket]mul\[UnderBracket]\
Comma\[UnderBracket]3}}], ".", 
   $CellContext`MyMatrixStyle[{{$CellContext`\[CapitalLambda]\[UnderBracket]\
Subscript\[UnderBracket]mul\[UnderBracket]Comma\[UnderBracket]1}, \
{$CellContext`\[CapitalLambda]\[UnderBracket]Subscript\[UnderBracket]mul\
\[UnderBracket]Comma\[UnderBracket]2}, {$CellContext`\[CapitalLambda]\
\[UnderBracket]Subscript\[UnderBracket]mul\[UnderBracket]Comma\[UnderBracket]\
3}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.59644905481316*^9, 3.596449150266604*^9, 
  3.596449265861745*^9, 3.596449572531996*^9, 3.596450733126753*^9, 
  3.5964507691751823`*^9, 3.5964515605954103`*^9, 3.596800944349717*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(W\\), \
\\(M\\)]\\).\\!\\(\\*SubscriptBox[\\(\[CapitalLambda]\\), \\(M\\)]\\): \"\>", 
   "\[InvisibleSpace]", 
   FrameBox[
    StyleBox[
     TagBox[GridBox[{
        {"Id", "0", "0"},
        {
         RowBox[{"-", "Id"}], "Id", "0"},
        {"0", 
         RowBox[{"-", "Id"}], "Id"},
        {"0", "0", 
         RowBox[{"-", "Id"}]}
       },
       AutoDelete->False,
       FrameStyle->{
         Thickness[0.1]},
       GridBoxDividers->{
        "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"],
     StripOnInput->False,
     FontWeight->Bold],
    RoundingRadius->1,
    StripOnInput->False], "\[InvisibleSpace]", "\<\".\"\>", 
   "\[InvisibleSpace]", 
   FrameBox[
    StyleBox[
     TagBox[GridBox[{
        {
         SubscriptBox["\[CapitalLambda]", 
          RowBox[{"mul", ",", "1"}]]},
        {
         SubscriptBox["\[CapitalLambda]", 
          RowBox[{"mul", ",", "2"}]]},
        {
         SubscriptBox["\[CapitalLambda]", 
          RowBox[{"mul", ",", "3"}]]}
       },
       AutoDelete->False,
       FrameStyle->{
         Thickness[0.1]},
       GridBoxDividers->{
        "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"],
     StripOnInput->False,
     FontWeight->Bold],
    RoundingRadius->1,
    StripOnInput->False]}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(W\), \
\(M\)]\).\!\(\*SubscriptBox[\(\[CapitalLambda]\), \(M\)]\): ", 
   $CellContext`MyMatrixStyle[{{$CellContext`Id, 0, 
      0}, {-$CellContext`Id, $CellContext`Id, 0}, {
     0, -$CellContext`Id, $CellContext`Id}, {0, 0, -$CellContext`Id}}], ".", 
   $CellContext`MyMatrixStyle[{{$CellContext`\[CapitalLambda]\[UnderBracket]\
Subscript\[UnderBracket]mul\[UnderBracket]Comma\[UnderBracket]1}, \
{$CellContext`\[CapitalLambda]\[UnderBracket]Subscript\[UnderBracket]mul\
\[UnderBracket]Comma\[UnderBracket]2}, {$CellContext`\[CapitalLambda]\
\[UnderBracket]Subscript\[UnderBracket]mul\[UnderBracket]Comma\[UnderBracket]\
3}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.59644905481316*^9, 3.596449150266604*^9, 
  3.596449265861745*^9, 3.596449572531996*^9, 3.596450733126753*^9, 
  3.5964507691751823`*^9, 3.5964515605954103`*^9, 3.5968009443530893`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations of Motion", "Subsection",
 CellChangeTimes->{{3.593433341752919*^9, 3.59343336524277*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{
     SubscriptBox["M", "G"], ".", 
     RowBox[{"(", 
      RowBox[{
       SubsuperscriptBox["u", "G", "E"], "-", 
       SubsuperscriptBox["u", "G", "S"]}], ")"}]}],
    FontWeight->"Bold"], 
   StyleBox[" ",
    FontWeight->"Bold"], 
   RowBox[{
    StyleBox["-",
     FontWeight->"Bold"], 
    StyleBox[" ",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox[
      RowBox[{
       SubscriptBox["h", "G"], "\[CapitalDelta]t"}],
      FontWeight->"Bold"], 
     StyleBox[" ",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox["-",
       FontWeight->"Bold"], 
      StyleBox[" ",
       FontWeight->"Bold"], 
      RowBox[{
       RowBox[{
        StyleBox[
         SubscriptBox["W", "L"],
         FontWeight->"Bold"], 
        StyleBox[".",
         FontWeight->"Bold"], 
        SubscriptBox[
         StyleBox["\[CapitalLambda]",
          FontWeight->"Bold"], 
         StyleBox["L",
          FontWeight->"Bold"]]}], 
       RowBox[{
        StyleBox["-",
         FontWeight->"Bold"], 
        StyleBox[" ",
         FontWeight->"Bold"], 
        RowBox[{
         SubscriptBox[
          StyleBox["W",
           FontWeight->"Bold"], 
          StyleBox["mul",
           FontWeight->"Bold"]], ".", 
         StyleBox[
          SubscriptBox["\[CapitalLambda]", "mul"],
          FontWeight->"Bold"]}]}]}]}]}]}]}], 
  StyleBox[" ",
   FontWeight->"Bold"], 
  StyleBox["=",
   FontWeight->"Bold"], 
  StyleBox[" ",
   FontWeight->"Bold"], 
  StyleBox["0",
   FontWeight->"Bold"]}]], "Text",
 CellChangeTimes->{{3.593433370965098*^9, 3.593433371606682*^9}, {
   3.593433721130929*^9, 3.5934338797708187`*^9}, {3.593433925900642*^9, 
   3.593433957389843*^9}, 3.5934340333871717`*^9, 3.593435303965279*^9, {
   3.594449995582383*^9, 3.594450000292701*^9}, {3.596450773289029*^9, 
   3.596450774138183*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["(",
       FontWeight->"Bold"], 
      RowBox[{
       SubscriptBox[
        StyleBox["M",
         FontWeight->"Bold"], "G"], "//", "MyMatrixStyle"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox["u", "G", "E"], "//", "MyMatrixStyle"}], ")"}], 
       "-", 
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox["u", "G", "S"], "//", "MyMatrixStyle"}], ")"}]}], 
      ")"}]}], ",", 
    RowBox[{"\"\< \>\"", "-", " ", 
     RowBox[{"\[CapitalDelta]t", 
      RowBox[{"(", " ", 
       RowBox[{
        SubscriptBox["h", "G"], " ", "//", "MyMatrixStyle"}], ")"}]}]}], ",", 
    
    RowBox[{"\"\< \>\"", "-", 
     RowBox[{
      RowBox[{
       StyleBox["(",
        FontWeight->"Bold"], 
       RowBox[{
        SubscriptBox[
         StyleBox["W",
          FontWeight->"Bold"], "L"], "//", "MyMatrixStyle"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[CapitalLambda]", "L"], " ", "//", "MyMatrixStyle"}], 
       ")"}]}]}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{
        StyleBox["(",
         FontWeight->"Bold"], 
        RowBox[{
         RowBox[{"ExpandMatrix", "[", 
          RowBox[{
           SubscriptBox["W", "M"], "/.", " ", "repWmul"}], "]"}], "//", 
         "MyMatrixStyle"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalLambda]", "M"], " ", "//", "MyMatrixStyle"}], 
        ")"}]}]}], " ", "==", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "1"}], "}"}]}], "]"}], "//", "MyMatrixStyle"}], 
      ")"}]}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.593433959799199*^9, 3.593433975621641*^9}, {
  3.593434012045555*^9, 3.593434407700556*^9}, {3.593434475968649*^9, 
  3.593434503993433*^9}, {3.593434876350909*^9, 3.5934348947706623`*^9}, {
  3.593435006638548*^9, 3.593435109978529*^9}}],

Cell[BoxData[
 TemplateBox[{RowBox[{
     FrameBox[
      StyleBox[
       TagBox[
        GridBox[{{
           SubscriptBox["M", "1"], "0", "0", "0"}, {"0", 
           SubscriptBox["M", "2"], "0", "0"}, {"0", "0", 
           SubscriptBox["M", "3"], "0"}, {"0", "0", "0", 
           SubscriptBox["M", "4"]}}, AutoDelete -> False, FrameStyle -> {
           Thickness[0.1]}, 
         GridBoxDividers -> {
          "Columns" -> {False, {True}, False}, 
           "Rows" -> {False, {True}, False}}, 
         GridBoxItemSize -> {
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"], 
       StripOnInput -> False, FontWeight -> Bold], RoundingRadius -> 1, 
      StripOnInput -> False], ".", 
     RowBox[{"(", 
       RowBox[{
         FrameBox[
          StyleBox[
           TagBox[
            GridBox[{{
               SubsuperscriptBox["u", "1", "E"]}, {
               SubsuperscriptBox["u", "2", "E"]}, {
               SubsuperscriptBox["u", "3", "E"]}, {
               SubsuperscriptBox["u", "4", "E"]}}, AutoDelete -> False, 
             FrameStyle -> {
               Thickness[0.1]}, 
             GridBoxDividers -> {
              "Columns" -> {False, {True}, False}, 
               "Rows" -> {False, {True}, False}}, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"], 
           StripOnInput -> False, FontWeight -> Bold], RoundingRadius -> 1, 
          StripOnInput -> False], "-", 
         FrameBox[
          StyleBox[
           TagBox[
            GridBox[{{
               SubsuperscriptBox["u", "1", "S"]}, {
               SubsuperscriptBox["u", "2", "S"]}, {
               SubsuperscriptBox["u", "3", "S"]}, {
               SubsuperscriptBox["u", "4", "S"]}}, AutoDelete -> False, 
             FrameStyle -> {
               Thickness[0.1]}, 
             GridBoxDividers -> {
              "Columns" -> {False, {True}, False}, 
               "Rows" -> {False, {True}, False}}, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"], 
           StripOnInput -> False, FontWeight -> Bold], RoundingRadius -> 1, 
          StripOnInput -> False]}], ")"}]}],RowBox[{"\" \"", "-", 
     RowBox[{"\[CapitalDelta]t", " ", 
       FrameBox[
        StyleBox[
         TagBox[
          GridBox[{{
             SubscriptBox["h", "1"]}, {
             SubscriptBox["h", "2"]}, {
             SubscriptBox["h", "3"]}, {
             SubscriptBox["h", "4"]}}, AutoDelete -> False, FrameStyle -> {
             Thickness[0.1]}, 
           GridBoxDividers -> {
            "Columns" -> {False, {True}, False}, 
             "Rows" -> {False, {True}, False}}, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"], 
         StripOnInput -> False, FontWeight -> Bold], RoundingRadius -> 1, 
        StripOnInput -> False]}]}],RowBox[{"\" \"", "-", 
     RowBox[{
       FrameBox[
        StyleBox[
         TagBox[
          GridBox[{{
             SubscriptBox["W", 
              RowBox[{"loc", ",", "1"}]], "0", "0", "0"}, {"0", 
             SubscriptBox["W", 
              RowBox[{"loc", ",", "2"}]], "0", "0"}, {"0", "0", 
             SubscriptBox["W", 
              RowBox[{"loc", ",", "3"}]], "0"}, {"0", "0", "0", 
             SubscriptBox["W", 
              RowBox[{"loc", ",", "4"}]]}}, AutoDelete -> False, FrameStyle -> {
             Thickness[0.1]}, 
           GridBoxDividers -> {
            "Columns" -> {False, {True}, False}, 
             "Rows" -> {False, {True}, False}}, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"], 
         StripOnInput -> False, FontWeight -> Bold], RoundingRadius -> 1, 
        StripOnInput -> False], ".", 
       FrameBox[
        StyleBox[
         TagBox[
          GridBox[{{
             SubscriptBox["\[CapitalLambda]", 
              RowBox[{"loc", ",", "1"}]]}, {
             SubscriptBox["\[CapitalLambda]", 
              RowBox[{"loc", ",", "2"}]]}, {
             SubscriptBox["\[CapitalLambda]", 
              RowBox[{"loc", ",", "3"}]]}, {
             SubscriptBox["\[CapitalLambda]", 
              RowBox[{"loc", ",", "4"}]]}}, AutoDelete -> False, FrameStyle -> {
             Thickness[0.1]}, 
           GridBoxDividers -> {
            "Columns" -> {False, {True}, False}, 
             "Rows" -> {False, {True}, False}}, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"], 
         StripOnInput -> False, FontWeight -> Bold], RoundingRadius -> 1, 
        StripOnInput -> False]}]}],RowBox[{
     RowBox[{"-", 
       RowBox[{
         FrameBox[
          StyleBox[
           TagBox[
            GridBox[{{"Id", "0", "0"}, {
               RowBox[{"-", "Id"}], "Id", "0"}, {"0", 
               RowBox[{"-", "Id"}], "Id"}, {"0", "0", 
               RowBox[{"-", "Id"}]}}, AutoDelete -> False, FrameStyle -> {
               Thickness[0.1]}, 
             GridBoxDividers -> {
              "Columns" -> {False, {True}, False}, 
               "Rows" -> {False, {True}, False}}, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"], 
           StripOnInput -> False, FontWeight -> Bold], RoundingRadius -> 1, 
          StripOnInput -> False], ".", 
         FrameBox[
          StyleBox[
           TagBox[
            GridBox[{{
               SubscriptBox["\[CapitalLambda]", 
                RowBox[{"mul", ",", "1"}]]}, {
               SubscriptBox["\[CapitalLambda]", 
                RowBox[{"mul", ",", "2"}]]}, {
               SubscriptBox["\[CapitalLambda]", 
                RowBox[{"mul", ",", "3"}]]}}, AutoDelete -> False, FrameStyle -> {
               Thickness[0.1]}, 
             GridBoxDividers -> {
              "Columns" -> {False, {True}, False}, 
               "Rows" -> {False, {True}, False}}, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"], 
           StripOnInput -> False, FontWeight -> Bold], RoundingRadius -> 1, 
          StripOnInput -> False]}]}], "\[Equal]", 
     FrameBox[
      StyleBox[
       TagBox[
        GridBox[{{"0"}, {"0"}, {"0"}, {"0"}}, AutoDelete -> False, FrameStyle -> {
           Thickness[0.1]}, 
         GridBoxDividers -> {
          "Columns" -> {False, {True}, False}, 
           "Rows" -> {False, {True}, False}}, 
         GridBoxItemSize -> {
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"], 
       StripOnInput -> False, FontWeight -> Bold], RoundingRadius -> 1, 
      StripOnInput -> False]}]},
  "RowDefault"]], "Output",
 CellChangeTimes->{3.59644905488449*^9, 3.5964491838200893`*^9, 
  3.59644926594384*^9, 3.596449572709549*^9, 3.5964507750841427`*^9, 
  3.596451560669788*^9, 3.596800944895959*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Building G Matrix", "Subsection",
 CellChangeTimes->{{3.5934346300461597`*^9, 3.5934346344828453`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rep", " ", "=", 
   RowBox[{"{", 
    RowBox[{"Id", "\[Rule]", " ", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SuperscriptBox[
          SubscriptBox["W", "L"], "T"], "\[CenterDot]", 
         SuperscriptBox[
          SubscriptBox["M", "G"], "Inv"], "\[CenterDot]", 
         SubscriptBox["W", "L"], " "}], 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["W", "L"], "T"], "\[CenterDot]", 
         SuperscriptBox[
          SubscriptBox["M", "G"], "Inv"], "\[CenterDot]", 
         SubscriptBox["W", 
          RowBox[{"M", ",", "rep"}]], " "}]},
       {
        RowBox[{
         SuperscriptBox[
          SubscriptBox["W", 
           RowBox[{"M", ",", "rep"}]], "T"], "\[CenterDot]", 
         SuperscriptBox[
          SubscriptBox["M", "G"], "Inv"], "\[CenterDot]", 
         SubscriptBox["W", "L"], " "}], 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["W", 
           RowBox[{"M", ",", "rep"}]], "T"], "\[CenterDot]", 
         SuperscriptBox[
          SubscriptBox["M", "G"], "Inv"], "\[CenterDot]", 
         SubscriptBox["W", 
          RowBox[{"M", ",", "rep"}]], " "}]}
      }], ")"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<G:\>\"", ",", 
   RowBox[{
    RowBox[{"G", " ", "/.", " ", "rep"}], " ", "//", "MatrixForm"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["G", "MM"], "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["W", 
       RowBox[{"M", ",", "rep"}]], "T"], "\[CenterDot]", 
     SuperscriptBox[
      SubscriptBox["M", "G"], "Inv"], "\[CenterDot]", 
     SubscriptBox["W", 
      RowBox[{"M", ",", "rep"}]]}], "  ", "/.", " ", "rep"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Det[\!\(\*SubscriptBox[\(G\), \(MM\)]\)]: \>\"", ",", 
   RowBox[{"Det", "[", 
    SubscriptBox["G", "MM"], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<\!\(\*SubscriptBox[\(G\), \(MM\)]\):\>\"", ",", 
    RowBox[{
     SubscriptBox["G", "MM"], "//", " ", "MatrixForm"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"MassMatrixBody", "[", "k_", "]"}], ":=", 
     RowBox[{"DiagonalMatrix", "[", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"makeSpecialSymb", "[", 
          RowBox[{"\"\<\[Alpha]\>\"", ",", "k"}], "]"}], "m"}], ",", 
        RowBox[{"makeSpecialSymb", "[", 
         RowBox[{"\"\<\[Alpha]\>\"", ",", "k"}], "]"}], ",", 
        RowBox[{"makeSpecialSymb", "[", 
         RowBox[{"\"\<\[Alpha]\>\"", ",", "k"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"makeSpecialSymb", "[", 
         RowBox[{
          RowBox[{"SubscriptBox", "[", 
           RowBox[{"\"\<\[CapitalTheta]\>\"", ",", 
            RowBox[{"ToString", "[", "k", "]"}]}], "]"}], ",", "1"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"makeSpecialSymb", "[", 
         RowBox[{
          RowBox[{"SubscriptBox", "[", 
           RowBox[{"\"\<\[CapitalTheta]\>\"", ",", 
            RowBox[{"ToString", "[", "k", "]"}]}], "]"}], ",", "2"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"makeSpecialSymb", "[", 
         RowBox[{
          RowBox[{"SubscriptBox", "[", 
           RowBox[{"\"\<\[CapitalTheta]\>\"", ",", 
            RowBox[{"ToString", "[", "k", "]"}]}], "]"}], ",", "3"}], "]"}]}],
        "}"}], "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"MassMatrixBody", "[", "k_", "]"}], ":=", " ", 
     RowBox[{"(", GridBox[{
        {"2", "3"},
        {"4", "1"}
       }], ")"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"massMatrixRep", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"makeSpecialSymb", "[", 
       RowBox[{"\"\<M\>\"", ",", "#1"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"Scalar", "[", 
        RowBox[{"makeSpecialSymb", "[", 
         RowBox[{"\"\<\[Alpha]\>\"", ",", "#1"}], "]"}], "]"}], " ", "M"}]}], 
     " ", "&"}], "/@", " ", 
    RowBox[{"Range", "[", "nSplitBodies", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["G", 
     RowBox[{"MM", ",", "num"}]], "=", 
    RowBox[{"ExpandMatrix", "[", 
     RowBox[{
      SubscriptBox["G", "MM"], " ", "/.", " ", "massMatrixRep"}], " ", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\!\(\*SubscriptBox[\(G\), \(MM, num\)]\):\>\"", ",", 
   RowBox[{
    SubscriptBox["G", 
     RowBox[{"MM", ",", "num"}]], " ", "//", "MatrixForm"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.5934357400358047`*^9, 3.59343580749901*^9}, {
   3.593440560221789*^9, 3.5934406732102747`*^9}, {3.593440845486856*^9, 
   3.593440868976699*^9}, {3.593441245842751*^9, 3.5934412666222477`*^9}, {
   3.59344133104856*^9, 3.5934413567117968`*^9}, {3.593441391200665*^9, 
   3.593441409972906*^9}, {3.593441556651772*^9, 3.593441560294496*^9}, {
   3.593441672381371*^9, 3.5934416901722097`*^9}, {3.593441721841292*^9, 
   3.593441736850801*^9}, {3.5934417695161457`*^9, 3.59344184545879*^9}, {
   3.5934423892142067`*^9, 3.5934423945431557`*^9}, {3.593442475630437*^9, 
   3.593442484596931*^9}, {3.593442545196066*^9, 3.593442653170313*^9}, {
   3.593445420935994*^9, 3.5934454211731033`*^9}, {3.594450158902178*^9, 
   3.5944502075545673`*^9}, {3.594450328236637*^9, 3.594450394700859*^9}, {
   3.5944506386429987`*^9, 3.5944506471972713`*^9}, {3.594450705856556*^9, 
   3.59445073200194*^9}, {3.594453559663715*^9, 3.594453621894538*^9}, {
   3.594453697807345*^9, 3.594453715775543*^9}, {3.594453753579206*^9, 
   3.5944541761900454`*^9}, {3.594454226021469*^9, 3.594454230914711*^9}, {
   3.594454279330655*^9, 3.594454369003025*^9}, {3.594454403101995*^9, 
   3.5944544300438213`*^9}, 3.594454480449379*^9, {3.594454510746278*^9, 
   3.594454604244377*^9}, {3.5944548461810293`*^9, 3.594454967912013*^9}, {
   3.594455380170627*^9, 3.594455393177146*^9}, {3.59446978134918*^9, 
   3.59446980489089*^9}, 3.5944698672904263`*^9, {3.5944699778721123`*^9, 
   3.594469992866397*^9}, {3.594470049392405*^9, 3.594470070762534*^9}, {
   3.5944701649401293`*^9, 3.594470190885592*^9}, {3.594471273018259*^9, 
   3.594471296682062*^9}, {3.594531223860124*^9, 3.594531236716119*^9}, {
   3.5964492088224697`*^9, 3.596449378082781*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"G:\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["W", 
             RowBox[{"loc", ",", "1"}]], "T"], "\[CenterDot]", 
           SuperscriptBox[
            SubscriptBox["M", "1"], "Inv"]}], ")"}], "\[CenterDot]", 
         SubscriptBox["W", 
          RowBox[{"loc", ",", "1"}]]}], "0", "0", "0", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["W", 
           RowBox[{"loc", ",", "1"}]], "T"], "\[CenterDot]", 
         SuperscriptBox[
          SubscriptBox["M", "1"], "Inv"]}], "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["W", 
             RowBox[{"loc", ",", "2"}]], "T"], "\[CenterDot]", 
           SuperscriptBox[
            SubscriptBox["M", "2"], "Inv"]}], ")"}], "\[CenterDot]", 
         SubscriptBox["W", 
          RowBox[{"loc", ",", "2"}]]}], "0", "0", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["W", 
             RowBox[{"loc", ",", "2"}]], "T"], "\[CenterDot]", 
           SuperscriptBox[
            SubscriptBox["M", "2"], "Inv"]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["W", 
           RowBox[{"loc", ",", "2"}]], "T"], "\[CenterDot]", 
         SuperscriptBox[
          SubscriptBox["M", "2"], "Inv"]}], "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["W", 
             RowBox[{"loc", ",", "3"}]], "T"], "\[CenterDot]", 
           SuperscriptBox[
            SubscriptBox["M", "3"], "Inv"]}], ")"}], "\[CenterDot]", 
         SubscriptBox["W", 
          RowBox[{"loc", ",", "3"}]]}], "0", "0", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["W", 
             RowBox[{"loc", ",", "3"}]], "T"], "\[CenterDot]", 
           SuperscriptBox[
            SubscriptBox["M", "3"], "Inv"]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["W", 
           RowBox[{"loc", ",", "3"}]], "T"], "\[CenterDot]", 
         SuperscriptBox[
          SubscriptBox["M", "3"], "Inv"]}]},
       {"0", "0", "0", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["W", 
             RowBox[{"loc", ",", "4"}]], "T"], "\[CenterDot]", 
           SuperscriptBox[
            SubscriptBox["M", "4"], "Inv"]}], ")"}], "\[CenterDot]", 
         SubscriptBox["W", 
          RowBox[{"loc", ",", "4"}]]}], "0", "0", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["W", 
             RowBox[{"loc", ",", "4"}]], "T"], "\[CenterDot]", 
           SuperscriptBox[
            SubscriptBox["M", "4"], "Inv"]}], ")"}]}]},
       {
        RowBox[{
         SuperscriptBox[
          SubscriptBox["M", "1"], "Inv"], "\[CenterDot]", 
         SubscriptBox["W", 
          RowBox[{"loc", ",", "1"}]]}], 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["M", "2"], "Inv"], "\[CenterDot]", 
           SubscriptBox["W", 
            RowBox[{"loc", ",", "2"}]]}], ")"}]}], "0", "0", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["M", "1"], "Inv"], "+", 
         SuperscriptBox[
          SubscriptBox["M", "2"], "Inv"]}], 
        RowBox[{"-", 
         SuperscriptBox[
          SubscriptBox["M", "2"], "Inv"]}], "0"},
       {"0", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["M", "2"], "Inv"], "\[CenterDot]", 
         SubscriptBox["W", 
          RowBox[{"loc", ",", "2"}]]}], 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["M", "3"], "Inv"], "\[CenterDot]", 
           SubscriptBox["W", 
            RowBox[{"loc", ",", "3"}]]}], ")"}]}], "0", 
        RowBox[{"-", 
         SuperscriptBox[
          SubscriptBox["M", "2"], "Inv"]}], 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["M", "2"], "Inv"], "+", 
         SuperscriptBox[
          SubscriptBox["M", "3"], "Inv"]}], 
        RowBox[{"-", 
         SuperscriptBox[
          SubscriptBox["M", "3"], "Inv"]}]},
       {"0", "0", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["M", "3"], "Inv"], "\[CenterDot]", 
         SubscriptBox["W", 
          RowBox[{"loc", ",", "3"}]]}], 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["M", "4"], "Inv"], "\[CenterDot]", 
           SubscriptBox["W", 
            RowBox[{"loc", ",", "4"}]]}], ")"}]}], "0", 
        RowBox[{"-", 
         SuperscriptBox[
          SubscriptBox["M", "3"], "Inv"]}], 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["M", "3"], "Inv"], "+", 
         SuperscriptBox[
          SubscriptBox["M", "4"], "Inv"]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["G:", 
   MatrixForm[{{
      $CellContext`BlockMultiply[
       $CellContext`BlockMultiply[
        $CellContext`BlockTransp[$CellContext`W\[UnderBracket]Subscript\
\[UnderBracket]loc\[UnderBracket]Comma\[UnderBracket]1], 
        $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]1]], $CellContext`W\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]1], 0, 0, 0, 
      $CellContext`BlockMultiply[
       $CellContext`BlockTransp[$CellContext`W\[UnderBracket]Subscript\
\[UnderBracket]loc\[UnderBracket]Comma\[UnderBracket]1], 
       $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]1]], 0, 0}, {0, 
      $CellContext`BlockMultiply[
       $CellContext`BlockMultiply[
        $CellContext`BlockTransp[$CellContext`W\[UnderBracket]Subscript\
\[UnderBracket]loc\[UnderBracket]Comma\[UnderBracket]2], 
        $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]2]], $CellContext`W\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]2], 0, 0, -$CellContext`BlockMultiply[
        $CellContext`BlockTransp[$CellContext`W\[UnderBracket]Subscript\
\[UnderBracket]loc\[UnderBracket]Comma\[UnderBracket]2], 
        $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]2]], 
      $CellContext`BlockMultiply[
       $CellContext`BlockTransp[$CellContext`W\[UnderBracket]Subscript\
\[UnderBracket]loc\[UnderBracket]Comma\[UnderBracket]2], 
       $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]2]], 0}, {0, 0, 
      $CellContext`BlockMultiply[
       $CellContext`BlockMultiply[
        $CellContext`BlockTransp[$CellContext`W\[UnderBracket]Subscript\
\[UnderBracket]loc\[UnderBracket]Comma\[UnderBracket]3], 
        $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]3]], $CellContext`W\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]3], 0, 0, -$CellContext`BlockMultiply[
        $CellContext`BlockTransp[$CellContext`W\[UnderBracket]Subscript\
\[UnderBracket]loc\[UnderBracket]Comma\[UnderBracket]3], 
        $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]3]], 
      $CellContext`BlockMultiply[
       $CellContext`BlockTransp[$CellContext`W\[UnderBracket]Subscript\
\[UnderBracket]loc\[UnderBracket]Comma\[UnderBracket]3], 
       $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]3]]}, {0, 0, 0, 
      $CellContext`BlockMultiply[
       $CellContext`BlockMultiply[
        $CellContext`BlockTransp[$CellContext`W\[UnderBracket]Subscript\
\[UnderBracket]loc\[UnderBracket]Comma\[UnderBracket]4], 
        $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]4]], $CellContext`W\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]4], 0, 0, -$CellContext`BlockMultiply[
        $CellContext`BlockTransp[$CellContext`W\[UnderBracket]Subscript\
\[UnderBracket]loc\[UnderBracket]Comma\[UnderBracket]4], 
        $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]4]]}, {
      $CellContext`BlockMultiply[
       $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]1], $CellContext`W\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]1], -$CellContext`BlockMultiply[
        $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]2], $CellContext`W\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]2], 0, 
      0, $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]1] + \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]2],\
 -$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]\
2], 0}, {0, 
      $CellContext`BlockMultiply[
       $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]2], $CellContext`W\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]2], -$CellContext`BlockMultiply[
        $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]3], $CellContext`W\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]3], 
      0, -$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]2], \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]2] + \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]3],\
 -$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]\
3]}, {0, 0, 
      $CellContext`BlockMultiply[
       $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]3], $CellContext`W\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]3], -$CellContext`BlockMultiply[
        $CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]4], $CellContext`W\[UnderBracket]Subscript\[UnderBracket]loc\
\[UnderBracket]Comma\[UnderBracket]4], 
      0, -$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]3], \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]3] + \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]4]}\
}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.596449239251397*^9, 3.596449333588211*^9}, 
   3.596449379062735*^9, 3.596449572779005*^9, 3.596450778131496*^9, 
   3.596451560737837*^9, 3.596800945124608*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Det[\\!\\(\\*SubscriptBox[\\(G\\), \\(MM\\)]\\)]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["M", "1"], "Inv"], " ", 
     SuperscriptBox[
      SubscriptBox["M", "2"], "Inv"], " ", 
     SuperscriptBox[
      SubscriptBox["M", "3"], "Inv"]}], "+", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["M", "1"], "Inv"], " ", 
     SuperscriptBox[
      SubscriptBox["M", "2"], "Inv"], " ", 
     SuperscriptBox[
      SubscriptBox["M", "4"], "Inv"]}], "+", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["M", "1"], "Inv"], " ", 
     SuperscriptBox[
      SubscriptBox["M", "3"], "Inv"], " ", 
     SuperscriptBox[
      SubscriptBox["M", "4"], "Inv"]}], "+", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["M", "2"], "Inv"], " ", 
     SuperscriptBox[
      SubscriptBox["M", "3"], "Inv"], " ", 
     SuperscriptBox[
      SubscriptBox["M", "4"], "Inv"]}]}]}],
  SequenceForm[
  "Det[\!\(\*SubscriptBox[\(G\), \(MM\)]\)]: ", \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]1] \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]2] \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]3] + \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]1] \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]2] \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]4] + \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]1] \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]3] \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]4] + \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]2] \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]3] \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.596449239251397*^9, 3.596449333588211*^9}, 
   3.596449379062735*^9, 3.596449572779005*^9, 3.596450778131496*^9, 
   3.596451560737837*^9, 3.59680094524855*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(G\\), \\(MM\\)]\\):\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         SuperscriptBox[
          SubscriptBox["M", "1"], "Inv"], "+", 
         SuperscriptBox[
          SubscriptBox["M", "2"], "Inv"]}], 
        RowBox[{"-", 
         SuperscriptBox[
          SubscriptBox["M", "2"], "Inv"]}], "0"},
       {
        RowBox[{"-", 
         SuperscriptBox[
          SubscriptBox["M", "2"], "Inv"]}], 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["M", "2"], "Inv"], "+", 
         SuperscriptBox[
          SubscriptBox["M", "3"], "Inv"]}], 
        RowBox[{"-", 
         SuperscriptBox[
          SubscriptBox["M", "3"], "Inv"]}]},
       {"0", 
        RowBox[{"-", 
         SuperscriptBox[
          SubscriptBox["M", "3"], "Inv"]}], 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["M", "3"], "Inv"], "+", 
         SuperscriptBox[
          SubscriptBox["M", "4"], "Inv"]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["\!\(\*SubscriptBox[\(G\), \(MM\)]\):", 
   MatrixForm[{{$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]1] + \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]2],\
 -$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]\
2], 0}, {-$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]2], \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]2] + \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]3],\
 -$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]\
3]}, {0, -$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\
\[UnderBracket]3], \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]3] + \
$CellContext`BlockInv[$CellContext`M\[UnderBracket]Subscript\[UnderBracket]4]}\
}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.596449239251397*^9, 3.596449333588211*^9}, 
   3.596449379062735*^9, 3.596449572779005*^9, 3.596450778131496*^9, 
   3.596451560737837*^9, 3.596800945252359*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(G\\), \\(MM, num\\)]\\):\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         FractionBox[
          SuperscriptBox["M", "Inv"], 
          SubscriptBox["\[Alpha]", "1"]], "+", 
         FractionBox[
          SuperscriptBox["M", "Inv"], 
          SubscriptBox["\[Alpha]", "2"]]}], 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["M", "Inv"], 
          SubscriptBox["\[Alpha]", "2"]]}], "0"},
       {
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["M", "Inv"], 
          SubscriptBox["\[Alpha]", "2"]]}], 
        RowBox[{
         FractionBox[
          SuperscriptBox["M", "Inv"], 
          SubscriptBox["\[Alpha]", "2"]], "+", 
         FractionBox[
          SuperscriptBox["M", "Inv"], 
          SubscriptBox["\[Alpha]", "3"]]}], 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["M", "Inv"], 
          SubscriptBox["\[Alpha]", "3"]]}]},
       {"0", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["M", "Inv"], 
          SubscriptBox["\[Alpha]", "3"]]}], 
        RowBox[{
         FractionBox[
          SuperscriptBox["M", "Inv"], 
          SubscriptBox["\[Alpha]", "3"]], "+", 
         FractionBox[
          SuperscriptBox["M", "Inv"], 
          SubscriptBox["\[Alpha]", "4"]]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["\!\(\*SubscriptBox[\(G\), \(MM, num\)]\):", 
   MatrixForm[{{$CellContext`BlockInv[$CellContext`M]/$CellContext`Scalar[$\
CellContext`\[Alpha]\[UnderBracket]Subscript\[UnderBracket]1] + \
$CellContext`BlockInv[$CellContext`M]/$CellContext`Scalar[$CellContext`\
\[Alpha]\[UnderBracket]Subscript\[UnderBracket]2], \
-$CellContext`BlockInv[$CellContext`M]/$CellContext`Scalar[$CellContext`\
\[Alpha]\[UnderBracket]Subscript\[UnderBracket]2], 
      0}, {-$CellContext`BlockInv[$CellContext`M]/$CellContext`Scalar[$\
CellContext`\[Alpha]\[UnderBracket]Subscript\[UnderBracket]2], \
$CellContext`BlockInv[$CellContext`M]/$CellContext`Scalar[$CellContext`\
\[Alpha]\[UnderBracket]Subscript\[UnderBracket]2] + \
$CellContext`BlockInv[$CellContext`M]/$CellContext`Scalar[$CellContext`\
\[Alpha]\[UnderBracket]Subscript\[UnderBracket]3], \
-$CellContext`BlockInv[$CellContext`M]/$CellContext`Scalar[$CellContext`\
\[Alpha]\[UnderBracket]Subscript\[UnderBracket]3]}, {
     0, -$CellContext`BlockInv[$CellContext`M]/$CellContext`Scalar[$\
CellContext`\[Alpha]\[UnderBracket]Subscript\[UnderBracket]3], \
$CellContext`BlockInv[$CellContext`M]/$CellContext`Scalar[$CellContext`\
\[Alpha]\[UnderBracket]Subscript\[UnderBracket]3] + \
$CellContext`BlockInv[$CellContext`M]/$CellContext`Scalar[$CellContext`\
\[Alpha]\[UnderBracket]Subscript\[UnderBracket]4]}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.596449239251397*^9, 3.596449333588211*^9}, 
   3.596449379062735*^9, 3.596449572779005*^9, 3.596450778131496*^9, 
   3.596451560737837*^9, 3.596800945432938*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Build ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["G", "MM"], " ", "=", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["W", "M"], "T"], 
      SubsuperscriptBox["M", "G", 
       RowBox[{"-", "1"}]], 
      SubscriptBox["W", "M"]}], "=", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["W", "M"], "T"], 
       RowBox[{"D", "\[CenterDot]", 
        SubscriptBox["W", "M"]}], 
       SuperscriptBox[
        OverscriptBox["M", "_"], 
        RowBox[{"-", "1"}]]}], "=", 
      RowBox[{"L", 
       SuperscriptBox[
        OverscriptBox["M", "_"], 
        RowBox[{"-", "1"}]]}]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", because we can write ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["M", "G", 
     RowBox[{"-", "1"}]], 
    SubscriptBox["W", "M"], " ", "as", " ", 
    RowBox[{"D", "\[CenterDot]", 
     SubscriptBox["W", "M"]}], " ", 
    SuperscriptBox[
     OverscriptBox["M", "_"], 
     RowBox[{"-", "1"}]], " "}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Subsubsection",
 CellChangeTimes->{{3.594552706767625*^9, 3.5945531149543533`*^9}, {
  3.594553223705352*^9, 3.594553225987911*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"LMatrixRep", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"makeSpecialSymb", "[", 
       RowBox[{"\"\<M\>\"", ",", "#1"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"Scalar", "[", 
        RowBox[{"makeSpecialSymb", "[", 
         RowBox[{"\"\<\[Alpha]\>\"", ",", "#1"}], "]"}], "]"}], " ", "Id"}]}],
      " ", "&"}], "/@", " ", 
    RowBox[{"Range", "[", "nSplitBodies", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LMatrixRep2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"makeSpecialSymb", "[", 
       RowBox[{"\"\<\[Alpha]\>\"", ",", "#1"}], "]"}], " ", "\[Rule]", " ", 
      FractionBox["1", "nMultiplicity"]}], "  ", "&"}], "/@", " ", 
    RowBox[{"Range", "[", "nSplitBodies", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["W", 
        RowBox[{"M", ",", "rep"}]], "T"], "\[CenterDot]", 
      SuperscriptBox[
       SubscriptBox["M", "G"], "Inv"], "\[CenterDot]", 
      SubscriptBox["W", 
       RowBox[{"M", ",", "rep"}]]}], "  ", "/.", " ", "rep"}], " ", "/.", " ",
     "LMatrixRep"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<L: \>\"", ",", 
    RowBox[{"L", " ", "//", "MatrixForm"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["L", "num"], "=", 
   RowBox[{"ExpandMatrix", "[", 
    RowBox[{
     RowBox[{"L", " ", "/.", " ", 
      RowBox[{"BlockInverse", " ", "\[Rule]", " ", "Inverse"}]}], " ", "/.", 
     " ", 
     RowBox[{"Id", "\[Rule]", " ", 
      RowBox[{"IdentityMatrix", "[", "6", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\!\(\*SubscriptBox[\(L\), \(num\)]\): \>\"", ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "num"], " ", "/.", " ", "LMatrixRep2"}], " ", "//", 
    "MatrixForm"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["LInv", "num"], "=", 
   RowBox[{
    RowBox[{"Inverse", "[", 
     SubscriptBox["L", "num"], "]"}], "/.", " ", "LMatrixRep2"}]}], " ", ";", 
  " ", 
  RowBox[{"Print", "[", 
   RowBox[{"\"\<\!\(\*SubscriptBox[\(LInv\), \(num\)]\): \>\"", ",", 
    RowBox[{
     SubscriptBox["LInv", "num"], "//", "MatrixForm"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5945532275629263`*^9, 3.594553425359675*^9}, {
  3.594553475808591*^9, 3.5945535063008537`*^9}, {3.594553588453808*^9, 
  3.59455361121774*^9}, {3.5945536830027657`*^9, 3.594553684933989*^9}, {
  3.594559130243062*^9, 3.594559238458467*^9}, {3.594559296844491*^9, 
  3.594559301725574*^9}, {3.594559393238749*^9, 3.594559416194708*^9}, {
  3.594559454026112*^9, 3.594559497066945*^9}, {3.594559558968398*^9, 
  3.594559593134776*^9}, {3.5945597103232203`*^9, 3.594559742859826*^9}, {
  3.596349484151231*^9, 3.596349517813339*^9}, {3.596358891070156*^9, 
  3.5963589036212883`*^9}, {3.5963589356040363`*^9, 3.596358936016056*^9}, {
  3.596436175879456*^9, 3.596436209003693*^9}, {3.596436303941183*^9, 
  3.596436317671953*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"L: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         FractionBox[
          SuperscriptBox["Id", "Inv"], 
          SubscriptBox["\[Alpha]", "1"]], "+", 
         FractionBox[
          SuperscriptBox["Id", "Inv"], 
          SubscriptBox["\[Alpha]", "2"]]}], 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["Id", "Inv"], 
          SubscriptBox["\[Alpha]", "2"]]}], "0"},
       {
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["Id", "Inv"], 
          SubscriptBox["\[Alpha]", "2"]]}], 
        RowBox[{
         FractionBox[
          SuperscriptBox["Id", "Inv"], 
          SubscriptBox["\[Alpha]", "2"]], "+", 
         FractionBox[
          SuperscriptBox["Id", "Inv"], 
          SubscriptBox["\[Alpha]", "3"]]}], 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["Id", "Inv"], 
          SubscriptBox["\[Alpha]", "3"]]}]},
       {"0", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["Id", "Inv"], 
          SubscriptBox["\[Alpha]", "3"]]}], 
        RowBox[{
         FractionBox[
          SuperscriptBox["Id", "Inv"], 
          SubscriptBox["\[Alpha]", "3"]], "+", 
         FractionBox[
          SuperscriptBox["Id", "Inv"], 
          SubscriptBox["\[Alpha]", "4"]]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["L: ", 
   MatrixForm[{{$CellContext`BlockInv[$CellContext`Id]/$CellContext`Scalar[$\
CellContext`\[Alpha]\[UnderBracket]Subscript\[UnderBracket]1] + \
$CellContext`BlockInv[$CellContext`Id]/$CellContext`Scalar[$CellContext`\
\[Alpha]\[UnderBracket]Subscript\[UnderBracket]2], \
-$CellContext`BlockInv[$CellContext`Id]/$CellContext`Scalar[$CellContext`\
\[Alpha]\[UnderBracket]Subscript\[UnderBracket]2], 
      0}, {-$CellContext`BlockInv[$CellContext`Id]/$CellContext`Scalar[$\
CellContext`\[Alpha]\[UnderBracket]Subscript\[UnderBracket]2], \
$CellContext`BlockInv[$CellContext`Id]/$CellContext`Scalar[$CellContext`\
\[Alpha]\[UnderBracket]Subscript\[UnderBracket]2] + \
$CellContext`BlockInv[$CellContext`Id]/$CellContext`Scalar[$CellContext`\
\[Alpha]\[UnderBracket]Subscript\[UnderBracket]3], \
-$CellContext`BlockInv[$CellContext`Id]/$CellContext`Scalar[$CellContext`\
\[Alpha]\[UnderBracket]Subscript\[UnderBracket]3]}, {
     0, -$CellContext`BlockInv[$CellContext`Id]/$CellContext`Scalar[$\
CellContext`\[Alpha]\[UnderBracket]Subscript\[UnderBracket]3], \
$CellContext`BlockInv[$CellContext`Id]/$CellContext`Scalar[$CellContext`\
\[Alpha]\[UnderBracket]Subscript\[UnderBracket]3] + \
$CellContext`BlockInv[$CellContext`Id]/$CellContext`Scalar[$CellContext`\
\[Alpha]\[UnderBracket]Subscript\[UnderBracket]4]}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.596449054985251*^9, 3.596449266090137*^9, 
  3.5964495729425287`*^9, 3.596450800935432*^9, 3.596451560805529*^9, 
  3.59680094605336*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(num\\)]\\): \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"8", "0", "0", "0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
        "0"},
       {"0", "8", "0", "0", "0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
        "0"},
       {"0", "0", "8", "0", "0", "0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "8", "0", "0", "0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "8", "0", "0", "0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "8", "0", "0", "0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "0"},
       {
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "8", "0", "0", "0", "0", 
        "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0"},
       {"0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "8", "0", "0", "0", "0", 
        "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0"},
       {"0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "8", "0", "0", "0", "0", 
        "0", 
        RowBox[{"-", "4"}], "0", "0", "0"},
       {"0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "8", "0", "0", "0", "0", 
        "0", 
        RowBox[{"-", "4"}], "0", "0"},
       {"0", "0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "8", "0", "0", "0", "0", 
        "0", 
        RowBox[{"-", "4"}], "0"},
       {"0", "0", "0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "8", "0", "0", "0", "0", 
        "0", 
        RowBox[{"-", "4"}]},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "8", "0", "0", "0", "0", 
        "0"},
       {"0", "0", "0", "0", "0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "8", "0", "0", "0", 
        "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "8", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "8", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "8", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
        RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "8"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["\!\(\*SubscriptBox[\(L\), \(num\)]\): ", 
   MatrixForm[CompressedData["
1:eJxTTMoPymNiYGAQgmIOBuzgz////3FI4QSjZtHeLFxyo2YNb7PwgVGzqGcW
AHbZYcE=
    "]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.596449054985251*^9, 3.596449266090137*^9, 
  3.5964495729425287`*^9, 3.596450800935432*^9, 3.596451560805529*^9, 
  3.59680094607344*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(LInv\\), \\(num\\)]\\): \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["3", "16"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["1", "16"], "0", "0", "0", "0", "0"},
       {"0", 
        FractionBox["3", "16"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["1", "16"], "0", "0", "0", "0"},
       {"0", "0", 
        FractionBox["3", "16"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["1", "16"], "0", "0", "0"},
       {"0", "0", "0", 
        FractionBox["3", "16"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["1", "16"], "0", "0"},
       {"0", "0", "0", "0", 
        FractionBox["3", "16"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["1", "16"], "0"},
       {"0", "0", "0", "0", "0", 
        FractionBox["3", "16"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["1", "16"]},
       {
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["1", "4"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0"},
       {"0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["1", "4"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0"},
       {"0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["1", "4"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0"},
       {"0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["1", "4"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0"},
       {"0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["1", "4"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0"},
       {"0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["1", "4"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"]},
       {
        FractionBox["1", "16"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["3", "16"], "0", "0", "0", "0", "0"},
       {"0", 
        FractionBox["1", "16"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["3", "16"], "0", "0", "0", "0"},
       {"0", "0", 
        FractionBox["1", "16"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["3", "16"], "0", "0", "0"},
       {"0", "0", "0", 
        FractionBox["1", "16"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["3", "16"], "0", "0"},
       {"0", "0", "0", "0", 
        FractionBox["1", "16"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["3", "16"], "0"},
       {"0", "0", "0", "0", "0", 
        FractionBox["1", "16"], "0", "0", "0", "0", "0", 
        FractionBox["1", "8"], "0", "0", "0", "0", "0", 
        FractionBox["3", "16"]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["\!\(\*SubscriptBox[\(LInv\), \(num\)]\): ", 
   MatrixForm[{{
      Rational[3, 16], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[1, 16], 0, 0, 0, 0, 0}, {0, 
      Rational[3, 16], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[1, 16], 0, 0, 0, 0}, {0, 0, 
      Rational[3, 16], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[1, 16], 0, 0, 0}, {0, 0, 0, 
      Rational[3, 16], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[1, 16], 0, 0}, {0, 0, 0, 0, 
      Rational[3, 16], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[1, 16], 0}, {0, 0, 0, 0, 0, 
      Rational[3, 16], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[1, 16]}, {
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[1, 4], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0}, {0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[1, 4], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0}, {0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[1, 4], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0}, {0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[1, 4], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0}, {0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[1, 4], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0}, {0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[1, 4], 0, 0, 0, 0, 0, 
      Rational[1, 8]}, {
      Rational[1, 16], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[3, 16], 0, 0, 0, 0, 0}, {0, 
      Rational[1, 16], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[3, 16], 0, 0, 0, 0}, {0, 0, 
      Rational[1, 16], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[3, 16], 0, 0, 0}, {0, 0, 0, 
      Rational[1, 16], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[3, 16], 0, 0}, {0, 0, 0, 0, 
      Rational[1, 16], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[3, 16], 0}, {0, 0, 0, 0, 0, 
      Rational[1, 16], 0, 0, 0, 0, 0, 
      Rational[1, 8], 0, 0, 0, 0, 0, 
      Rational[3, 16]}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.596449054985251*^9, 3.596449266090137*^9, 
  3.5964495729425287`*^9, 3.596450800935432*^9, 3.596451560805529*^9, 
  3.5968009461832857`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Test\
\>", "Subsection",
 CellChangeTimes->{{3.596801165974311*^9, 3.5968011798814774`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"NDOFu", " ", "=", " ", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"uBack", " ", "=", " ", 
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{"#1", "&"}], " ", ",", 
    RowBox[{"nSplitBodies", "*", "NDOFu"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gamma", " ", "=", " ", 
   RowBox[{
    RowBox[{"uBack", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"nSplitBodies", "-", "1"}], ")"}], "*", "NDOFu"}]}], "]"}], 
     "]"}], " ", "-", " ", 
    RowBox[{"uBack", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"NDOFu", "+", "1"}], ";;", 
       RowBox[{
        RowBox[{"(", "nSplitBodies", ")"}], "*", "NDOFu"}]}], "]"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5968009871541367`*^9, 3.596801002823236*^9}, {
  3.596801054386674*^9, 3.596801163499652*^9}, {3.596801204265492*^9, 
  3.596801205695592*^9}, {3.596801251177883*^9, 3.596801285032192*^9}, {
  3.596801317503912*^9, 3.5968015075958843`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", 
   ",", "9", ",", "10", ",", "11", ",", "12", ",", "13", ",", "14", ",", "15",
    ",", "16", ",", "17", ",", "18", ",", "19", ",", "20", ",", "21", ",", 
   "22", ",", "23", ",", "24"}], "}"}]], "Output",
 CellChangeTimes->{
  3.596801159124528*^9, 3.596801369696185*^9, {3.596801443708737*^9, 
   3.59680149439644*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "6"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.596801159124528*^9, 3.596801369696185*^9, {3.596801443708737*^9, 
   3.596801494398522*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["LInv", "num"], ".", "gamma"}]], "Input",
 CellChangeTimes->{{3.596801560906382*^9, 3.596801565030212*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["9", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["9", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["9", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["9", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["9", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["9", "4"]}], ",", 
   RowBox[{"-", "3"}], ",", 
   RowBox[{"-", "3"}], ",", 
   RowBox[{"-", "3"}], ",", 
   RowBox[{"-", "3"}], ",", 
   RowBox[{"-", "3"}], ",", 
   RowBox[{"-", "3"}], ",", 
   RowBox[{"-", 
    FractionBox["9", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["9", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["9", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["9", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["9", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["9", "4"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.596801566257608*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{927, 1075},
WindowMargins->{{Automatic, 261}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 129, 2, 45, "Subsection"],
Cell[711, 26, 4394, 89, 429, "Input"],
Cell[5108, 117, 15644, 385, 2095, "Input"],
Cell[20755, 504, 9768, 247, 1089, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30560, 756, 175, 2, 93, "Title"],
Cell[30738, 760, 142, 5, 81, "Subtitle"],
Cell[CellGroupData[{
Cell[30905, 769, 114, 1, 45, "Subsection"],
Cell[31022, 772, 374, 7, 51, "Text"],
Cell[31399, 781, 1195, 20, 77, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32631, 806, 180, 2, 45, "Subsection"],
Cell[32814, 810, 246, 5, 31, "Text"],
Cell[CellGroupData[{
Cell[33085, 819, 3195, 79, 135, "Input"],
Cell[CellGroupData[{
Cell[36305, 902, 316, 7, 23, "Print"],
Cell[36624, 911, 1099, 34, 82, "Print"]
}, Open  ]]
}, Open  ]],
Cell[37750, 949, 234, 5, 31, "Text"],
Cell[CellGroupData[{
Cell[38009, 958, 2648, 71, 132, "Input"],
Cell[CellGroupData[{
Cell[40682, 1033, 269, 6, 23, "Print"],
Cell[40954, 1041, 972, 30, 82, "Print"]
}, Open  ]]
}, Open  ]],
Cell[41953, 1075, 342, 6, 31, "Text"],
Cell[42298, 1083, 861, 23, 99, "Input"],
Cell[43162, 1108, 91, 1, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43290, 1114, 243, 5, 45, "Subsection"],
Cell[43536, 1121, 625, 19, 70, "Text"],
Cell[CellGroupData[{
Cell[44186, 1144, 581, 10, 55, "Input"],
Cell[44770, 1156, 211, 3, 32, "Output"],
Cell[44984, 1161, 432, 11, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45453, 1177, 2381, 53, 209, "Input"],
Cell[47837, 1232, 420, 11, 32, "Output"],
Cell[48260, 1245, 971, 22, 23, "Print"]
}, Open  ]],
Cell[49246, 1270, 394, 13, 31, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49677, 1288, 144, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[49846, 1293, 1288, 30, 79, "Input"],
Cell[51137, 1325, 1538, 38, 98, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52712, 1368, 3198, 74, 70, "Input"],
Cell[55913, 1444, 1408, 36, 86, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57358, 1485, 681, 16, 55, "Input"],
Cell[58042, 1503, 1292, 35, 86, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59371, 1543, 4353, 98, 190, "Input"],
Cell[63727, 1643, 3401, 85, 116, "Print"]
}, Open  ]],
Cell[67143, 1731, 92, 1, 32, "Input"],
Cell[67238, 1734, 6290, 139, 207, "Input"],
Cell[CellGroupData[{
Cell[73553, 1877, 2891, 57, 100, "Input"],
Cell[CellGroupData[{
Cell[76469, 1938, 2695, 69, 96, "Print"],
Cell[79167, 2009, 2474, 67, 82, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81702, 2083, 106, 1, 45, "Subsection"],
Cell[81811, 2086, 1886, 68, 34, "Text"],
Cell[CellGroupData[{
Cell[83722, 2158, 2108, 66, 103, "Input"],
Cell[85833, 2226, 6950, 162, 215, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[92832, 2394, 109, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[92966, 2399, 6665, 163, 451, "Input"],
Cell[CellGroupData[{
Cell[99656, 2566, 11254, 267, 159, "Print"],
Cell[110913, 2835, 2226, 50, 23, "Print"],
Cell[113142, 2887, 2692, 67, 62, "Print"],
Cell[115837, 2956, 3513, 83, 107, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[119399, 3045, 1238, 42, 76, "Subsubsection"],
Cell[CellGroupData[{
Cell[120662, 3091, 3157, 81, 262, "Input"],
Cell[CellGroupData[{
Cell[123844, 3176, 3420, 82, 107, "Print"],
Cell[127267, 3260, 3494, 79, 293, "Print"],
Cell[130764, 3341, 6336, 150, 509, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[137173, 3499, 103, 4, 71, "Subsection"],
Cell[CellGroupData[{
Cell[137301, 3507, 1069, 29, 121, "Input"],
Cell[138373, 3538, 439, 9, 89, "Output"],
Cell[138815, 3549, 692, 23, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139544, 3577, 146, 3, 32, "Input"],
Cell[139693, 3582, 893, 33, 49, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
